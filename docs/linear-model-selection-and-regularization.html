<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Linear Model Selection and Regularization | 208 Course Notes</title>
  <meta name="description" content="Chapter 7 Linear Model Selection and Regularization | 208 Course Notes" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Linear Model Selection and Regularization | 208 Course Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Linear Model Selection and Regularization | 208 Course Notes" />
  
  
  

<meta name="author" content="Abhishek Chakraborty" />


<meta name="date" content="2023-03-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="review-of-cv.html"/>
<link rel="next" href="tree-based-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">208 Course Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html"><i class="fa fa-check"></i><b>2</b> What is Machine Learning?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#what-is-machine-learning-1"><i class="fa fa-check"></i><b>2.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#question"><i class="fa fa-check"></i><b>2.2</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="2.3" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#statistical-learning-vs-machine-learning-vs-data-science"><i class="fa fa-check"></i><b>2.3</b> Statistical Learning vs Machine Learning vs Data Science</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#notations"><i class="fa fa-check"></i><b>2.4</b> Notations</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#notations-1"><i class="fa fa-check"></i><b>2.5</b> Notations</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#question-1"><i class="fa fa-check"></i><b>2.6</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="2.7" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#question-2"><i class="fa fa-check"></i><b>2.7</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="2.8" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-vs-unsupervised"><i class="fa fa-check"></i><b>2.8</b> Supervised vs Unsupervised</a></li>
<li class="chapter" data-level="2.9" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>2.9</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.10" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-1"><i class="fa fa-check"></i><b>2.10</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.11" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>2.11</b> Unsupervised Learning</a></li>
<li class="chapter" data-level="2.12" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#question-3"><i class="fa fa-check"></i><b>2.12</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="2.13" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-2"><i class="fa fa-check"></i><b>2.13</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.14" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-3"><i class="fa fa-check"></i><b>2.14</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.15" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-4"><i class="fa fa-check"></i><b>2.15</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.16" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-5"><i class="fa fa-check"></i><b>2.16</b> Supervised Learning</a></li>
<li class="chapter" data-level="2.17" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-why-estimate-fmathbfx"><i class="fa fa-check"></i><b>2.17</b> Supervised Learning: Why Estimate <span class="math inline">\(f(\mathbf{X})\)</span>?</a></li>
<li class="chapter" data-level="2.18" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-prediction-and-inference"><i class="fa fa-check"></i><b>2.18</b> Supervised Learning: Prediction and Inference</a></li>
<li class="chapter" data-level="2.19" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-prediction-and-inference-1"><i class="fa fa-check"></i><b>2.19</b> Supervised Learning: Prediction and Inference</a></li>
<li class="chapter" data-level="2.20" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-prediction"><i class="fa fa-check"></i><b>2.20</b> Supervised Learning: Prediction</a></li>
<li class="chapter" data-level="2.21" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#question-4"><i class="fa fa-check"></i><b>2.21</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="2.22" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-how-do-we-estimate-fmathbfx"><i class="fa fa-check"></i><b>2.22</b> Supervised Learning: How Do We Estimate <span class="math inline">\(f(\mathbf{X})\)</span>?</a></li>
<li class="chapter" data-level="2.23" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-parametric-methods"><i class="fa fa-check"></i><b>2.23</b> Supervised Learning: Parametric Methods</a></li>
<li class="chapter" data-level="2.24" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-parametric-methods-1"><i class="fa fa-check"></i><b>2.24</b> Supervised Learning: Parametric Methods</a></li>
<li class="chapter" data-level="2.25" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-non-parametric-methods"><i class="fa fa-check"></i><b>2.25</b> Supervised Learning: Non-parametric Methods</a></li>
<li class="chapter" data-level="2.26" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-flexibility-of-models"><i class="fa fa-check"></i><b>2.26</b> Supervised Learning: Flexibility of Models</a></li>
<li class="chapter" data-level="2.27" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-some-trade-offs"><i class="fa fa-check"></i><b>2.27</b> Supervised Learning: Some Trade-offs</a></li>
<li class="chapter" data-level="2.28" data-path="what-is-machine-learning.html"><a href="what-is-machine-learning.html#supervised-learning-some-trade-offs-1"><i class="fa fa-check"></i><b>2.28</b> Supervised Learning: Some Trade-offs</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html"><i class="fa fa-check"></i><b>3</b> Supervised Learning: Assessing Model Accuracy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-1"><i class="fa fa-check"></i><b>3.1</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.2" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-2"><i class="fa fa-check"></i><b>3.2</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.3" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-3"><i class="fa fa-check"></i><b>3.3</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.4" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-4"><i class="fa fa-check"></i><b>3.4</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.5" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-5"><i class="fa fa-check"></i><b>3.5</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.6" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-assessing-model-accuracy-6"><i class="fa fa-check"></i><b>3.6</b> Supervised Learning: Assessing Model Accuracy</a></li>
<li class="chapter" data-level="3.7" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-bias-variance-trade-off"><i class="fa fa-check"></i><b>3.7</b> Supervised Learning: Bias-Variance Trade-off</a></li>
<li class="chapter" data-level="3.8" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-bias-variance-trade-off-1"><i class="fa fa-check"></i><b>3.8</b> Supervised Learning: Bias-Variance Trade-off</a></li>
<li class="chapter" data-level="3.9" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#supervised-learning-bias-variance-trade-off-2"><i class="fa fa-check"></i><b>3.9</b> Supervised Learning: Bias-Variance Trade-off</a></li>
<li class="chapter" data-level="3.10" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-5"><i class="fa fa-check"></i><b>3.10</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="3.11" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#simple-linear-regression-slr"><i class="fa fa-check"></i><b>3.11</b> Simple Linear Regression (SLR)</a></li>
<li class="chapter" data-level="3.12" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-6"><i class="fa fa-check"></i><b>3.12</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="3.13" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-estimating-parameters"><i class="fa fa-check"></i><b>3.13</b> SLR: Estimating Parameters</a></li>
<li class="chapter" data-level="3.14" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-estimating-parameters-1"><i class="fa fa-check"></i><b>3.14</b> SLR: Estimating Parameters</a></li>
<li class="chapter" data-level="3.15" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-estimating-parameters-2"><i class="fa fa-check"></i><b>3.15</b> SLR: Estimating Parameters</a></li>
<li class="chapter" data-level="3.16" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#ames-housing-dataset"><i class="fa fa-check"></i><b>3.16</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="3.17" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#ames-housing-dataset-1"><i class="fa fa-check"></i><b>3.17</b> Ames Housing dataset</a></li>
<li class="chapter" data-level="3.18" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-estimating-parameters-3"><i class="fa fa-check"></i><b>3.18</b> SLR: Estimating Parameters</a></li>
<li class="chapter" data-level="3.19" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-model"><i class="fa fa-check"></i><b>3.19</b> SLR: Model</a></li>
<li class="chapter" data-level="3.20" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-model-1"><i class="fa fa-check"></i><b>3.20</b> SLR: Model</a></li>
<li class="chapter" data-level="3.21" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-prediction"><i class="fa fa-check"></i><b>3.21</b> SLR: Prediction</a></li>
<li class="chapter" data-level="3.22" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-interpreting-parameters"><i class="fa fa-check"></i><b>3.22</b> SLR: Interpreting Parameters</a></li>
<li class="chapter" data-level="3.23" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-assessing-accuracy-of-model"><i class="fa fa-check"></i><b>3.23</b> SLR: Assessing Accuracy of Model</a></li>
<li class="chapter" data-level="3.24" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#slr-assessing-accuracy-of-model-1"><i class="fa fa-check"></i><b>3.24</b> SLR: Assessing Accuracy of Model</a></li>
<li class="chapter" data-level="3.25" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#your-turn"><i class="fa fa-check"></i><b>3.25</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="3.26" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-7"><i class="fa fa-check"></i><b>3.26</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="3.27" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-8"><i class="fa fa-check"></i><b>3.27</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="3.28" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-9"><i class="fa fa-check"></i><b>3.28</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="3.29" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#regression-conditional-averaging"><i class="fa fa-check"></i><b>3.29</b> Regression: Conditional Averaging</a></li>
<li class="chapter" data-level="3.30" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#regression-conditional-averaging-1"><i class="fa fa-check"></i><b>3.30</b> Regression: Conditional Averaging</a></li>
<li class="chapter" data-level="3.31" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#k-nearest-neighbors-regression"><i class="fa fa-check"></i><b>3.31</b> K-Nearest Neighbors Regression</a></li>
<li class="chapter" data-level="3.32" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#k-nearest-neighbors-regression-fit"><i class="fa fa-check"></i><b>3.32</b> K-Nearest Neighbors Regression: Fit</a></li>
<li class="chapter" data-level="3.33" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#k-nearest-neighbors-regression-prediction"><i class="fa fa-check"></i><b>3.33</b> K-Nearest Neighbors Regression: Prediction</a></li>
<li class="chapter" data-level="3.34" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#regression-methods-comparison"><i class="fa fa-check"></i><b>3.34</b> Regression Methods: Comparison</a></li>
<li class="chapter" data-level="3.35" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#your-turn-1"><i class="fa fa-check"></i><b>3.35</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="3.36" data-path="supervised-learning-assessing-model-accuracy.html"><a href="supervised-learning-assessing-model-accuracy.html#question-10"><i class="fa fa-check"></i><b>3.36</b> <span style="color:blue">Question!!!</span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression (MLR)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-estimating-parameters"><i class="fa fa-check"></i><b>4.1</b> MLR: Estimating Parameters</a></li>
<li class="chapter" data-level="4.2" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-estimating-parameters-1"><i class="fa fa-check"></i><b>4.2</b> MLR: Estimating Parameters</a></li>
<li class="chapter" data-level="4.3" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-estimating-parameters-2"><i class="fa fa-check"></i><b>4.3</b> MLR: Estimating Parameters</a></li>
<li class="chapter" data-level="4.4" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-interpreting-parameters"><i class="fa fa-check"></i><b>4.4</b> MLR: Interpreting Parameters</a></li>
<li class="chapter" data-level="4.5" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-prediction"><i class="fa fa-check"></i><b>4.5</b> MLR: Prediction</a></li>
<li class="chapter" data-level="4.6" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-assessing-accuracy-of-model"><i class="fa fa-check"></i><b>4.6</b> MLR: Assessing Accuracy of Model</a></li>
<li class="chapter" data-level="4.7" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#your-turn-2"><i class="fa fa-check"></i><b>4.7</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="4.8" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#mlr-assessing-accuracy-of-model-1"><i class="fa fa-check"></i><b>4.8</b> MLR: Assessing Accuracy of Model</a></li>
<li class="chapter" data-level="4.9" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#question-11"><i class="fa fa-check"></i><b>4.9</b> <span style="color:blue">Question!!!</span></a></li>
<li class="chapter" data-level="4.10" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#k-nearest-neighbors-regression-multiple-predictors"><i class="fa fa-check"></i><b>4.10</b> K-Nearest Neighbors Regression (multiple predictors)</a></li>
<li class="chapter" data-level="4.11" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#k-nearest-neighbors-regression-multiple-predictors-1"><i class="fa fa-check"></i><b>4.11</b> K-Nearest Neighbors Regression (multiple predictors)</a></li>
<li class="chapter" data-level="4.12" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#linear-regression-vs-k-nearest-neighbors"><i class="fa fa-check"></i><b>4.12</b> Linear Regression vs K-Nearest Neighbors</a></li>
<li class="chapter" data-level="4.13" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#classification-problems"><i class="fa fa-check"></i><b>4.13</b> Classification Problems</a></li>
<li class="chapter" data-level="4.14" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#classification-problems-example"><i class="fa fa-check"></i><b>4.14</b> Classification Problems: Example</a></li>
<li class="chapter" data-level="4.15" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#classification-problems-example-1"><i class="fa fa-check"></i><b>4.15</b> Classification Problems: Example</a></li>
<li class="chapter" data-level="4.16" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#why-not-linear-regression"><i class="fa fa-check"></i><b>4.16</b> Why Not Linear Regression?</a></li>
<li class="chapter" data-level="4.17" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#why-not-linear-regression-1"><i class="fa fa-check"></i><b>4.17</b> Why Not Linear Regression?</a></li>
<li class="chapter" data-level="4.18" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression"><i class="fa fa-check"></i><b>4.18</b> Logistic Regression</a></li>
<li class="chapter" data-level="4.19" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.19</b> Logistic Regression</a></li>
<li class="chapter" data-level="4.20" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#your-turn-3"><i class="fa fa-check"></i><b>4.20</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="4.21" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-example"><i class="fa fa-check"></i><b>4.21</b> Logistic Regression: Example</a></li>
<li class="chapter" data-level="4.22" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-estimating-parameters"><i class="fa fa-check"></i><b>4.22</b> Logistic Regression: Estimating Parameters</a></li>
<li class="chapter" data-level="4.23" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-individual-predictions"><i class="fa fa-check"></i><b>4.23</b> Logistic Regression: Individual Predictions</a></li>
<li class="chapter" data-level="4.24" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-test-set-predictions"><i class="fa fa-check"></i><b>4.24</b> Logistic Regression: Test Set Predictions</a></li>
<li class="chapter" data-level="4.25" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-test-set-predictions-1"><i class="fa fa-check"></i><b>4.25</b> Logistic Regression: Test Set Predictions</a></li>
<li class="chapter" data-level="4.26" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#logistic-regression-performance"><i class="fa fa-check"></i><b>4.26</b> Logistic Regression: Performance</a></li>
<li class="chapter" data-level="4.27" data-path="multiple-linear-regression-mlr.html"><a href="multiple-linear-regression-mlr.html#confusion-matrix-terms"><i class="fa fa-check"></i><b>4.27</b> Confusion Matrix Terms</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html"><i class="fa fa-check"></i><b>5</b> K-Nearest Neighbors Classifier</a>
<ul>
<li class="chapter" data-level="5.1" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-4"><i class="fa fa-check"></i><b>5.1</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="5.2" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-nearest-neighbors-classifier-split-data"><i class="fa fa-check"></i><b>5.2</b> K-Nearest Neighbors Classifier: Split Data</a></li>
<li class="chapter" data-level="5.3" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-nearest-neighbors-classifier-build-model"><i class="fa fa-check"></i><b>5.3</b> K-Nearest Neighbors Classifier: Build Model</a></li>
<li class="chapter" data-level="5.4" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-nearest-neighbors-classifier-predictions"><i class="fa fa-check"></i><b>5.4</b> K-Nearest Neighbors Classifier: Predictions</a></li>
<li class="chapter" data-level="5.5" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-nearest-neighbors-classifier-performance"><i class="fa fa-check"></i><b>5.5</b> K-Nearest Neighbors Classifier: Performance</a></li>
<li class="chapter" data-level="5.6" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#roc-curve-and-auc"><i class="fa fa-check"></i><b>5.6</b> ROC Curve and AUC</a></li>
<li class="chapter" data-level="5.7" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#roc-curve-and-auc-1"><i class="fa fa-check"></i><b>5.7</b> ROC Curve and AUC</a></li>
<li class="chapter" data-level="5.8" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#data-splitting"><i class="fa fa-check"></i><b>5.8</b> Data Splitting</a></li>
<li class="chapter" data-level="5.9" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#resampling-methods"><i class="fa fa-check"></i><b>5.9</b> Resampling Methods</a></li>
<li class="chapter" data-level="5.10" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#cross-validation-cv"><i class="fa fa-check"></i><b>5.10</b> Cross-Validation (CV)</a></li>
<li class="chapter" data-level="5.11" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#leave-one-out-cross-validation-loocv"><i class="fa fa-check"></i><b>5.11</b> Leave-One-Out Cross-Validation (LOOCV)</a></li>
<li class="chapter" data-level="5.12" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#leave-one-out-cross-validation-loocv-1"><i class="fa fa-check"></i><b>5.12</b> Leave-One-Out Cross-Validation (LOOCV)</a></li>
<li class="chapter" data-level="5.13" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.13</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="5.14" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation"><i class="fa fa-check"></i><b>5.14</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.15" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation-1"><i class="fa fa-check"></i><b>5.15</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.16" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation-2"><i class="fa fa-check"></i><b>5.16</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.17" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation-3"><i class="fa fa-check"></i><b>5.17</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.18" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation-4"><i class="fa fa-check"></i><b>5.18</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.19" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-implementation-5"><i class="fa fa-check"></i><b>5.19</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Implementation</a></li>
<li class="chapter" data-level="5.20" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#k-fold-cross-validation-results"><i class="fa fa-check"></i><b>5.20</b> <span class="math inline">\(k\)</span>-Fold Cross-Validation: Results</a></li>
<li class="chapter" data-level="5.21" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#final-model-and-prediction-error-estimate"><i class="fa fa-check"></i><b>5.21</b> Final Model and Prediction Error Estimate</a></li>
<li class="chapter" data-level="5.22" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#variable-importance"><i class="fa fa-check"></i><b>5.22</b> Variable Importance</a></li>
<li class="chapter" data-level="5.23" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#bias-variance-trade-off-for-loocv-and-k-fold-cv"><i class="fa fa-check"></i><b>5.23</b> Bias-Variance Trade-off for LOOCV and <span class="math inline">\(k\)</span>-fold CV</a></li>
<li class="chapter" data-level="5.24" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-5"><i class="fa fa-check"></i><b>5.24</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="5.25" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-split-data"><i class="fa fa-check"></i><b>5.25</b> <span style="color:blue">Your Turn!!!</span>: Split Data</a></li>
<li class="chapter" data-level="5.26" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-perform-cv"><i class="fa fa-check"></i><b>5.26</b> <span style="color:blue">Your Turn!!!</span>: Perform CV</a></li>
<li class="chapter" data-level="5.27" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-observe-cv-results"><i class="fa fa-check"></i><b>5.27</b> <span style="color:blue">Your Turn!!!</span>: Observe CV Results</a></li>
<li class="chapter" data-level="5.28" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#your-turn-final-model"><i class="fa fa-check"></i><b>5.28</b> <span style="color:blue">Your Turn!!!</span>: Final Model</a></li>
<li class="chapter" data-level="5.29" data-path="k-nearest-neighbors-classifier.html"><a href="k-nearest-neighbors-classifier.html#mid-term-check"><i class="fa fa-check"></i><b>5.29</b> Mid-Term Check</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="review-of-cv.html"><a href="review-of-cv.html"><i class="fa fa-check"></i><b>6</b> Review of CV</a>
<ul>
<li class="chapter" data-level="6.1" data-path="review-of-cv.html"><a href="review-of-cv.html#data-leakage-a-serious-common-problem"><i class="fa fa-check"></i><b>6.1</b> Data Leakage (A Serious, Common Problem)</a></li>
<li class="chapter" data-level="6.2" data-path="review-of-cv.html"><a href="review-of-cv.html#data-preprocessing-and-feature-enginnering"><i class="fa fa-check"></i><b>6.2</b> Data Preprocessing and Feature Enginnering</a></li>
<li class="chapter" data-level="6.3" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-2"><i class="fa fa-check"></i><b>6.3</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.4" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-3"><i class="fa fa-check"></i><b>6.4</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.5" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-4"><i class="fa fa-check"></i><b>6.5</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.6" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-5"><i class="fa fa-check"></i><b>6.6</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.7" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-6"><i class="fa fa-check"></i><b>6.7</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.8" data-path="review-of-cv.html"><a href="review-of-cv.html#ames-housing-dataset-7"><i class="fa fa-check"></i><b>6.8</b> Ames Housing Dataset</a></li>
<li class="chapter" data-level="6.9" data-path="review-of-cv.html"><a href="review-of-cv.html#zero-variance-zv-andor-near-zero-variance-nzv-variables"><i class="fa fa-check"></i><b>6.9</b> Zero-Variance (zv) and/or Near-Zero Variance (nzv) Variables</a></li>
<li class="chapter" data-level="6.10" data-path="review-of-cv.html"><a href="review-of-cv.html#zero-variance-zv-andor-near-zero-variance-nzv-variables-1"><i class="fa fa-check"></i><b>6.10</b> Zero-Variance (zv) and/or Near-Zero Variance (nzv) Variables</a></li>
<li class="chapter" data-level="6.11" data-path="review-of-cv.html"><a href="review-of-cv.html#zero-variance-zv-andor-near-zero-variance-nzv-variables-2"><i class="fa fa-check"></i><b>6.11</b> Zero-Variance (zv) and/or Near-Zero Variance (nzv) Variables</a></li>
<li class="chapter" data-level="6.12" data-path="review-of-cv.html"><a href="review-of-cv.html#imputing-missing-entries"><i class="fa fa-check"></i><b>6.12</b> Imputing Missing Entries</a></li>
<li class="chapter" data-level="6.13" data-path="review-of-cv.html"><a href="review-of-cv.html#imputing-missing-entries-1"><i class="fa fa-check"></i><b>6.13</b> Imputing Missing Entries</a></li>
<li class="chapter" data-level="6.14" data-path="review-of-cv.html"><a href="review-of-cv.html#imputing-missing-entries-2"><i class="fa fa-check"></i><b>6.14</b> Imputing Missing Entries</a></li>
<li class="chapter" data-level="6.15" data-path="review-of-cv.html"><a href="review-of-cv.html#label-encoding-ordinal-categorical-variables"><i class="fa fa-check"></i><b>6.15</b> Label Encoding Ordinal Categorical Variables</a></li>
<li class="chapter" data-level="6.16" data-path="review-of-cv.html"><a href="review-of-cv.html#label-encoding-ordinal-categorical-variables-1"><i class="fa fa-check"></i><b>6.16</b> Label Encoding Ordinal Categorical Variables</a></li>
<li class="chapter" data-level="6.17" data-path="review-of-cv.html"><a href="review-of-cv.html#label-encoding-ordinal-categorical-variables-2"><i class="fa fa-check"></i><b>6.17</b> Label Encoding Ordinal Categorical Variables</a></li>
<li class="chapter" data-level="6.18" data-path="review-of-cv.html"><a href="review-of-cv.html#standardizing-centering-and-scaling-numeric-predictors"><i class="fa fa-check"></i><b>6.18</b> Standardizing (centering and scaling) Numeric Predictors</a></li>
<li class="chapter" data-level="6.19" data-path="review-of-cv.html"><a href="review-of-cv.html#lumping-predictors"><i class="fa fa-check"></i><b>6.19</b> Lumping Predictors</a></li>
<li class="chapter" data-level="6.20" data-path="review-of-cv.html"><a href="review-of-cv.html#one-hotdummy-encoding-categorical-predictors"><i class="fa fa-check"></i><b>6.20</b> One-hot/dummy Encoding Categorical Predictors</a></li>
<li class="chapter" data-level="6.21" data-path="review-of-cv.html"><a href="review-of-cv.html#one-hotdummy-encoding-categorical-predictors-1"><i class="fa fa-check"></i><b>6.21</b> One-hot/dummy Encoding Categorical Predictors</a></li>
<li class="chapter" data-level="6.22" data-path="review-of-cv.html"><a href="review-of-cv.html#preprocessing-steps"><i class="fa fa-check"></i><b>6.22</b> Preprocessing Steps</a></li>
<li class="chapter" data-level="6.23" data-path="review-of-cv.html"><a href="review-of-cv.html#preprocessing-with-recipes-package"><i class="fa fa-check"></i><b>6.23</b> Preprocessing With <code>recipes</code> Package</a></li>
<li class="chapter" data-level="6.24" data-path="review-of-cv.html"><a href="review-of-cv.html#preprocessing-with-recipes-package-1"><i class="fa fa-check"></i><b>6.24</b> Preprocessing With <code>recipes</code> Package</a></li>
<li class="chapter" data-level="6.25" data-path="review-of-cv.html"><a href="review-of-cv.html#training-model"><i class="fa fa-check"></i><b>6.25</b> Training Model</a></li>
<li class="chapter" data-level="6.26" data-path="review-of-cv.html"><a href="review-of-cv.html#training-model-1"><i class="fa fa-check"></i><b>6.26</b> Training Model</a></li>
<li class="chapter" data-level="6.27" data-path="review-of-cv.html"><a href="review-of-cv.html#training-model-2"><i class="fa fa-check"></i><b>6.27</b> Training Model</a></li>
<li class="chapter" data-level="6.28" data-path="review-of-cv.html"><a href="review-of-cv.html#final-model-and-test-set-error"><i class="fa fa-check"></i><b>6.28</b> Final Model and Test Set Error</a></li>
<li class="chapter" data-level="6.29" data-path="review-of-cv.html"><a href="review-of-cv.html#variable-importance-1"><i class="fa fa-check"></i><b>6.29</b> Variable Importance</a></li>
<li class="chapter" data-level="6.30" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-6"><i class="fa fa-check"></i><b>6.30</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="6.31" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-1"><i class="fa fa-check"></i><b>6.31</b> <span style="color:blue">Your Turn!!!</span> Step 1</a></li>
<li class="chapter" data-level="6.32" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-1-1"><i class="fa fa-check"></i><b>6.32</b> <span style="color:blue">Your Turn!!!</span> Step 1</a></li>
<li class="chapter" data-level="6.33" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-1-2"><i class="fa fa-check"></i><b>6.33</b> <span style="color:blue">Your Turn!!!</span> Step 1</a></li>
<li class="chapter" data-level="6.34" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-1-3"><i class="fa fa-check"></i><b>6.34</b> <span style="color:blue">Your Turn!!!</span> Step 1</a></li>
<li class="chapter" data-level="6.35" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-1-4"><i class="fa fa-check"></i><b>6.35</b> <span style="color:blue">Your Turn!!!</span> Step 1</a></li>
<li class="chapter" data-level="6.36" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-2"><i class="fa fa-check"></i><b>6.36</b> <span style="color:blue">Your Turn!!!</span> Step 2</a></li>
<li class="chapter" data-level="6.37" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-3"><i class="fa fa-check"></i><b>6.37</b> <span style="color:blue">Your Turn!!!</span> Step 3</a></li>
<li class="chapter" data-level="6.38" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-4"><i class="fa fa-check"></i><b>6.38</b> <span style="color:blue">Your Turn!!!</span> Step 4</a></li>
<li class="chapter" data-level="6.39" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-4-1"><i class="fa fa-check"></i><b>6.39</b> <span style="color:blue">Your Turn!!!</span> Step 4</a></li>
<li class="chapter" data-level="6.40" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-4-2"><i class="fa fa-check"></i><b>6.40</b> <span style="color:blue">Your Turn!!!</span> Step 4</a></li>
<li class="chapter" data-level="6.41" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-5"><i class="fa fa-check"></i><b>6.41</b> <span style="color:blue">Your Turn!!!</span> Step 5</a></li>
<li class="chapter" data-level="6.42" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-5-1"><i class="fa fa-check"></i><b>6.42</b> <span style="color:blue">Your Turn!!!</span> Step 5</a></li>
<li class="chapter" data-level="6.43" data-path="review-of-cv.html"><a href="review-of-cv.html#your-turn-step-5-2"><i class="fa fa-check"></i><b>6.43</b> <span style="color:blue">Your Turn!!!</span> Step 5</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html"><i class="fa fa-check"></i><b>7</b> Linear Model Selection and Regularization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#alternatives-to-least-squares"><i class="fa fa-check"></i><b>7.1</b> Alternatives to Least Squares</a></li>
<li class="chapter" data-level="7.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#shrinkageregularization-methods"><i class="fa fa-check"></i><b>7.2</b> Shrinkage/Regularization Methods</a></li>
<li class="chapter" data-level="7.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso"><i class="fa fa-check"></i><b>7.3</b> The Lasso</a></li>
<li class="chapter" data-level="7.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-1"><i class="fa fa-check"></i><b>7.4</b> The Lasso</a></li>
<li class="chapter" data-level="7.5" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-scaling-of-predictors"><i class="fa fa-check"></i><b>7.5</b> The Lasso: Scaling of Predictors</a></li>
<li class="chapter" data-level="7.6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation"><i class="fa fa-check"></i><b>7.6</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.7" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-1"><i class="fa fa-check"></i><b>7.7</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.8" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-2"><i class="fa fa-check"></i><b>7.8</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.9" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-3"><i class="fa fa-check"></i><b>7.9</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.10" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-4"><i class="fa fa-check"></i><b>7.10</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.11" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-5"><i class="fa fa-check"></i><b>7.11</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.12" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso-implementation-6"><i class="fa fa-check"></i><b>7.12</b> The Lasso: Implementation</a></li>
<li class="chapter" data-level="7.13" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-7"><i class="fa fa-check"></i><b>7.13</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.14" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-8"><i class="fa fa-check"></i><b>7.14</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.15" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-9"><i class="fa fa-check"></i><b>7.15</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.16" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-10"><i class="fa fa-check"></i><b>7.16</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.17" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-11"><i class="fa fa-check"></i><b>7.17</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.18" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-12"><i class="fa fa-check"></i><b>7.18</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.19" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-13"><i class="fa fa-check"></i><b>7.19</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.20" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-14"><i class="fa fa-check"></i><b>7.20</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.21" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-15"><i class="fa fa-check"></i><b>7.21</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.22" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-16"><i class="fa fa-check"></i><b>7.22</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.23" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-17"><i class="fa fa-check"></i><b>7.23</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.24" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-18"><i class="fa fa-check"></i><b>7.24</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.25" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#multivariate-adaptive-regression-splines-mars"><i class="fa fa-check"></i><b>7.25</b> Multivariate Adaptive Regression Splines (MARS)</a></li>
<li class="chapter" data-level="7.26" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-geometry"><i class="fa fa-check"></i><b>7.26</b> MARS: Geometry</a></li>
<li class="chapter" data-level="7.27" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-implementation"><i class="fa fa-check"></i><b>7.27</b> MARS: Implementation</a></li>
<li class="chapter" data-level="7.28" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-implementation-1"><i class="fa fa-check"></i><b>7.28</b> MARS: Implementation</a></li>
<li class="chapter" data-level="7.29" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-implementation-2"><i class="fa fa-check"></i><b>7.29</b> MARS: Implementation</a></li>
<li class="chapter" data-level="7.30" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-implementation-3"><i class="fa fa-check"></i><b>7.30</b> MARS: Implementation</a></li>
<li class="chapter" data-level="7.31" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-implementation-4"><i class="fa fa-check"></i><b>7.31</b> MARS: Implementation</a></li>
<li class="chapter" data-level="7.32" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars"><i class="fa fa-check"></i><b>7.32</b> MARS</a></li>
<li class="chapter" data-level="7.33" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation"><i class="fa fa-check"></i><b>7.33</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.34" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-1"><i class="fa fa-check"></i><b>7.34</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.35" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-2"><i class="fa fa-check"></i><b>7.35</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.36" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-3"><i class="fa fa-check"></i><b>7.36</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.37" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-4"><i class="fa fa-check"></i><b>7.37</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.38" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-5"><i class="fa fa-check"></i><b>7.38</b> MARS Without Feature Engineering: Implementation</a></li>
<li class="chapter" data-level="7.39" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-19"><i class="fa fa-check"></i><b>7.39</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.40" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-20"><i class="fa fa-check"></i><b>7.40</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.41" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-21"><i class="fa fa-check"></i><b>7.41</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.42" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-22"><i class="fa fa-check"></i><b>7.42</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.43" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-23"><i class="fa fa-check"></i><b>7.43</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.44" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-24"><i class="fa fa-check"></i><b>7.44</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.45" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-25"><i class="fa fa-check"></i><b>7.45</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.46" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-26"><i class="fa fa-check"></i><b>7.46</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.47" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-27"><i class="fa fa-check"></i><b>7.47</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.48" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-28"><i class="fa fa-check"></i><b>7.48</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="7.49" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#your-turn-29"><i class="fa fa-check"></i><b>7.49</b> <span style="color:blue">Your Turn!!!</span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>8</b> Tree-Based Methods</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#terminology-for-trees"><i class="fa fa-check"></i><b>8.1</b> Terminology for Trees</a></li>
<li class="chapter" data-level="8.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#terminology-for-trees-1"><i class="fa fa-check"></i><b>8.2</b> Terminology for Trees</a></li>
<li class="chapter" data-level="8.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-and-prediction"><i class="fa fa-check"></i><b>8.3</b> Building a Tree and Prediction</a></li>
<li class="chapter" data-level="8.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-and-prediction-1"><i class="fa fa-check"></i><b>8.4</b> Building a Tree and Prediction</a></li>
<li class="chapter" data-level="8.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-and-prediction-2"><i class="fa fa-check"></i><b>8.5</b> Building a Tree and Prediction</a></li>
<li class="chapter" data-level="8.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-and-prediction-3"><i class="fa fa-check"></i><b>8.6</b> Building a Tree and Prediction</a></li>
<li class="chapter" data-level="8.7" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-and-prediction-4"><i class="fa fa-check"></i><b>8.7</b> Building a Tree and Prediction</a></li>
<li class="chapter" data-level="8.8" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree"><i class="fa fa-check"></i><b>8.8</b> Building a Tree</a></li>
<li class="chapter" data-level="8.9" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-a-tree-1"><i class="fa fa-check"></i><b>8.9</b> Building a Tree</a></li>
<li class="chapter" data-level="8.10" data-path="tree-based-methods.html"><a href="tree-based-methods.html#tree-pruning"><i class="fa fa-check"></i><b>8.10</b> Tree Pruning</a></li>
<li class="chapter" data-level="8.11" data-path="tree-based-methods.html"><a href="tree-based-methods.html#tree-pruning-1"><i class="fa fa-check"></i><b>8.11</b> Tree Pruning</a></li>
<li class="chapter" data-level="8.12" data-path="tree-based-methods.html"><a href="tree-based-methods.html#building-an-optimal-tree"><i class="fa fa-check"></i><b>8.12</b> Building an Optimal Tree</a></li>
<li class="chapter" data-level="8.13" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation"><i class="fa fa-check"></i><b>8.13</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.14" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-1"><i class="fa fa-check"></i><b>8.14</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.15" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-2"><i class="fa fa-check"></i><b>8.15</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.16" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-3"><i class="fa fa-check"></i><b>8.16</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.17" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-4"><i class="fa fa-check"></i><b>8.17</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.18" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-5"><i class="fa fa-check"></i><b>8.18</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.19" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-6"><i class="fa fa-check"></i><b>8.19</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.20" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-7"><i class="fa fa-check"></i><b>8.20</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.21" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-8"><i class="fa fa-check"></i><b>8.21</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.22" data-path="tree-based-methods.html"><a href="tree-based-methods.html#trees"><i class="fa fa-check"></i><b>8.22</b> Trees</a></li>
<li class="chapter" data-level="8.23" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-9"><i class="fa fa-check"></i><b>8.23</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.24" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-10"><i class="fa fa-check"></i><b>8.24</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.25" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-11"><i class="fa fa-check"></i><b>8.25</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.26" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-tree-implementation-12"><i class="fa fa-check"></i><b>8.26</b> Regression Tree: Implementation</a></li>
<li class="chapter" data-level="8.27" data-path="tree-based-methods.html"><a href="tree-based-methods.html#classification-trees"><i class="fa fa-check"></i><b>8.27</b> Classification Trees</a></li>
<li class="chapter" data-level="8.28" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-30"><i class="fa fa-check"></i><b>8.28</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.29" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-31"><i class="fa fa-check"></i><b>8.29</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.30" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-32"><i class="fa fa-check"></i><b>8.30</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.31" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-33"><i class="fa fa-check"></i><b>8.31</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.32" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-34"><i class="fa fa-check"></i><b>8.32</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.33" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-35"><i class="fa fa-check"></i><b>8.33</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.34" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-36"><i class="fa fa-check"></i><b>8.34</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.35" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-37"><i class="fa fa-check"></i><b>8.35</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.36" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-38"><i class="fa fa-check"></i><b>8.36</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.37" data-path="tree-based-methods.html"><a href="tree-based-methods.html#ensemble-methods"><i class="fa fa-check"></i><b>8.37</b> Ensemble Methods</a></li>
<li class="chapter" data-level="8.38" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging"><i class="fa fa-check"></i><b>8.38</b> Bagging</a></li>
<li class="chapter" data-level="8.39" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-1"><i class="fa fa-check"></i><b>8.39</b> Bagging</a></li>
<li class="chapter" data-level="8.40" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-2"><i class="fa fa-check"></i><b>8.40</b> Bagging</a></li>
<li class="chapter" data-level="8.41" data-path="tree-based-methods.html"><a href="tree-based-methods.html#out-of-bag-error-estimation"><i class="fa fa-check"></i><b>8.41</b> Out-of-Bag Error Estimation</a></li>
<li class="chapter" data-level="8.42" data-path="tree-based-methods.html"><a href="tree-based-methods.html#variable-importance-measures"><i class="fa fa-check"></i><b>8.42</b> Variable Importance Measures</a></li>
<li class="chapter" data-level="8.43" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-implementation"><i class="fa fa-check"></i><b>8.43</b> Bagging: Implementation</a></li>
<li class="chapter" data-level="8.44" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-implementation-1"><i class="fa fa-check"></i><b>8.44</b> Bagging: Implementation</a></li>
<li class="chapter" data-level="8.45" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-implementation-2"><i class="fa fa-check"></i><b>8.45</b> Bagging: Implementation</a></li>
<li class="chapter" data-level="8.46" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-disadvantages"><i class="fa fa-check"></i><b>8.46</b> Bagging: Disadvantages</a></li>
<li class="chapter" data-level="8.47" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-disadvantages-1"><i class="fa fa-check"></i><b>8.47</b> Bagging: Disadvantages</a></li>
<li class="chapter" data-level="8.48" data-path="tree-based-methods.html"><a href="tree-based-methods.html#random-forests"><i class="fa fa-check"></i><b>8.48</b> Random Forests</a></li>
<li class="chapter" data-level="8.49" data-path="tree-based-methods.html"><a href="tree-based-methods.html#random-forests-implementation"><i class="fa fa-check"></i><b>8.49</b> Random Forests: Implementation</a></li>
<li class="chapter" data-level="8.50" data-path="tree-based-methods.html"><a href="tree-based-methods.html#random-forests-implementation-1"><i class="fa fa-check"></i><b>8.50</b> Random Forests: Implementation</a></li>
<li class="chapter" data-level="8.51" data-path="tree-based-methods.html"><a href="tree-based-methods.html#random-forests-implementation-2"><i class="fa fa-check"></i><b>8.51</b> Random Forests: Implementation</a></li>
<li class="chapter" data-level="8.52" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-39"><i class="fa fa-check"></i><b>8.52</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.53" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-40"><i class="fa fa-check"></i><b>8.53</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.54" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-41"><i class="fa fa-check"></i><b>8.54</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.55" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-42"><i class="fa fa-check"></i><b>8.55</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.56" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-43"><i class="fa fa-check"></i><b>8.56</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.57" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-44"><i class="fa fa-check"></i><b>8.57</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.58" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-45"><i class="fa fa-check"></i><b>8.58</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.59" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-46"><i class="fa fa-check"></i><b>8.59</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.60" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-47"><i class="fa fa-check"></i><b>8.60</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="8.61" data-path="tree-based-methods.html"><a href="tree-based-methods.html#your-turn-48"><i class="fa fa-check"></i><b>8.61</b> <span style="color:blue">Your Turn!!!</span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html"><i class="fa fa-check"></i><b>9</b> Support Vector Machines (SVM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#hyperplane"><i class="fa fa-check"></i><b>9.1</b> Hyperplane</a></li>
<li class="chapter" data-level="9.2" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#hyperplane-1"><i class="fa fa-check"></i><b>9.2</b> Hyperplane</a></li>
<li class="chapter" data-level="9.3" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#hyperplane-2"><i class="fa fa-check"></i><b>9.3</b> Hyperplane</a></li>
<li class="chapter" data-level="9.4" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#separating-hyperplane"><i class="fa fa-check"></i><b>9.4</b> Separating Hyperplane</a></li>
<li class="chapter" data-level="9.5" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#separating-hyperplane-1"><i class="fa fa-check"></i><b>9.5</b> Separating Hyperplane</a></li>
<li class="chapter" data-level="9.6" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#optimal-separating-hyperplane"><i class="fa fa-check"></i><b>9.6</b> Optimal Separating Hyperplane</a></li>
<li class="chapter" data-level="9.7" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#optimal-separating-hyperplane-1"><i class="fa fa-check"></i><b>9.7</b> Optimal Separating Hyperplane</a></li>
<li class="chapter" data-level="9.8" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#optimal-separating-hyperplane-2"><i class="fa fa-check"></i><b>9.8</b> Optimal Separating Hyperplane</a></li>
<li class="chapter" data-level="9.9" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#optimal-separating-hyperplane-issue-1"><i class="fa fa-check"></i><b>9.9</b> Optimal Separating Hyperplane: Issue 1</a></li>
<li class="chapter" data-level="9.10" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#optimal-separating-hyperplane-issue-2"><i class="fa fa-check"></i><b>9.10</b> Optimal Separating Hyperplane: Issue 2</a></li>
<li class="chapter" data-level="9.11" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier"><i class="fa fa-check"></i><b>9.11</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.12" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier-1"><i class="fa fa-check"></i><b>9.12</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.13" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier-2"><i class="fa fa-check"></i><b>9.13</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.14" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier-3"><i class="fa fa-check"></i><b>9.14</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.15" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier-4"><i class="fa fa-check"></i><b>9.15</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.16" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#support-vector-classifier-5"><i class="fa fa-check"></i><b>9.16</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="9.17" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries"><i class="fa fa-check"></i><b>9.17</b> Non-linear Boundaries</a></li>
<li class="chapter" data-level="9.18" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#feature-expansion"><i class="fa fa-check"></i><b>9.18</b> Feature Expansion</a></li>
<li class="chapter" data-level="9.19" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#feature-expansion-1"><i class="fa fa-check"></i><b>9.19</b> Feature Expansion</a></li>
<li class="chapter" data-level="9.20" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#feature-expansion-2"><i class="fa fa-check"></i><b>9.20</b> Feature Expansion</a></li>
<li class="chapter" data-level="9.21" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-circle-dataset"><i class="fa fa-check"></i><b>9.21</b> Non-linear Boundaries: Circle dataset</a></li>
<li class="chapter" data-level="9.22" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-circle-dataset-1"><i class="fa fa-check"></i><b>9.22</b> Non-linear Boundaries: Circle dataset</a></li>
<li class="chapter" data-level="9.23" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-circle-dataset-2"><i class="fa fa-check"></i><b>9.23</b> Non-linear Boundaries: Circle dataset</a></li>
<li class="chapter" data-level="9.24" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-spirals-dataset"><i class="fa fa-check"></i><b>9.24</b> Non-linear Boundaries: Spirals dataset</a></li>
<li class="chapter" data-level="9.25" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-spirals-dataset-1"><i class="fa fa-check"></i><b>9.25</b> Non-linear Boundaries: Spirals dataset</a></li>
<li class="chapter" data-level="9.26" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-spirals-dataset-2"><i class="fa fa-check"></i><b>9.26</b> Non-linear Boundaries: Spirals dataset</a></li>
<li class="chapter" data-level="9.27" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#non-linear-boundaries-spirals-dataset-3"><i class="fa fa-check"></i><b>9.27</b> Non-linear Boundaries: Spirals dataset</a></li>
<li class="chapter" data-level="9.28" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#summary"><i class="fa fa-check"></i><b>9.28</b> Summary</a></li>
<li class="chapter" data-level="9.29" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-49"><i class="fa fa-check"></i><b>9.29</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.30" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-50"><i class="fa fa-check"></i><b>9.30</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.31" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-51"><i class="fa fa-check"></i><b>9.31</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.32" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-52"><i class="fa fa-check"></i><b>9.32</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.33" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-53"><i class="fa fa-check"></i><b>9.33</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.34" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-54"><i class="fa fa-check"></i><b>9.34</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.35" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-55"><i class="fa fa-check"></i><b>9.35</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.36" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-56"><i class="fa fa-check"></i><b>9.36</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.37" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-57"><i class="fa fa-check"></i><b>9.37</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.38" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-58"><i class="fa fa-check"></i><b>9.38</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.39" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-59"><i class="fa fa-check"></i><b>9.39</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.40" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#summary-of-supervised-learning-methods"><i class="fa fa-check"></i><b>9.40</b> Summary of Supervised Learning Methods</a></li>
<li class="chapter" data-level="9.41" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks"><i class="fa fa-check"></i><b>9.41</b> Neural Networks</a></li>
<li class="chapter" data-level="9.42" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-1"><i class="fa fa-check"></i><b>9.42</b> Neural Networks</a></li>
<li class="chapter" data-level="9.43" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#biological-neural-networks"><i class="fa fa-check"></i><b>9.43</b> Biological Neural Networks</a></li>
<li class="chapter" data-level="9.44" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#artificial-neural-networks"><i class="fa fa-check"></i><b>9.44</b> Artificial Neural Networks</a></li>
<li class="chapter" data-level="9.45" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-2"><i class="fa fa-check"></i><b>9.45</b> Neural Networks</a></li>
<li class="chapter" data-level="9.46" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-3"><i class="fa fa-check"></i><b>9.46</b> Neural Networks</a></li>
<li class="chapter" data-level="9.47" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-4"><i class="fa fa-check"></i><b>9.47</b> Neural Networks</a></li>
<li class="chapter" data-level="9.48" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#your-turn-60"><i class="fa fa-check"></i><b>9.48</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="9.49" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-5"><i class="fa fa-check"></i><b>9.49</b> Neural Networks</a></li>
<li class="chapter" data-level="9.50" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-6"><i class="fa fa-check"></i><b>9.50</b> Neural Networks</a></li>
<li class="chapter" data-level="9.51" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-input-data"><i class="fa fa-check"></i><b>9.51</b> Neural Networks: Input Data</a></li>
<li class="chapter" data-level="9.52" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-network-architecture"><i class="fa fa-check"></i><b>9.52</b> Neural Networks: Network Architecture</a></li>
<li class="chapter" data-level="9.53" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-network-architecture-1"><i class="fa fa-check"></i><b>9.53</b> Neural Networks: Network Architecture</a></li>
<li class="chapter" data-level="9.54" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-network-architecture-2"><i class="fa fa-check"></i><b>9.54</b> Neural Networks: Network Architecture</a></li>
<li class="chapter" data-level="9.55" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-feedback-mechanism"><i class="fa fa-check"></i><b>9.55</b> Neural Networks: Feedback Mechanism</a></li>
<li class="chapter" data-level="9.56" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-feedback-mechanism-1"><i class="fa fa-check"></i><b>9.56</b> Neural Networks: Feedback Mechanism</a></li>
<li class="chapter" data-level="9.57" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-model-training"><i class="fa fa-check"></i><b>9.57</b> Neural Networks: Model Training</a></li>
<li class="chapter" data-level="9.58" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-model-training-1"><i class="fa fa-check"></i><b>9.58</b> Neural Networks: Model Training</a></li>
<li class="chapter" data-level="9.59" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html#neural-networks-further-topics"><i class="fa fa-check"></i><b>9.59</b> Neural Networks: Further Topics</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html"><i class="fa fa-check"></i><b>10</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="10.1" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#unsupervised-learning-2"><i class="fa fa-check"></i><b>10.1</b> Unsupervised Learning</a></li>
<li class="chapter" data-level="10.2" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>10.2</b> Principal Components Analysis (PCA)</a></li>
<li class="chapter" data-level="10.3" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-example"><i class="fa fa-check"></i><b>10.3</b> PCA: Example</a></li>
<li class="chapter" data-level="10.4" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-example-1"><i class="fa fa-check"></i><b>10.4</b> PCA: Example</a></li>
<li class="chapter" data-level="10.5" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-data-requirements"><i class="fa fa-check"></i><b>10.5</b> PCA: Data Requirements</a></li>
<li class="chapter" data-level="10.6" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-toy-example"><i class="fa fa-check"></i><b>10.6</b> PCA: Toy Example</a></li>
<li class="chapter" data-level="10.7" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-toy-example-1"><i class="fa fa-check"></i><b>10.7</b> PCA: Toy Example</a></li>
<li class="chapter" data-level="10.8" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-toy-example-2"><i class="fa fa-check"></i><b>10.8</b> PCA: Toy Example</a></li>
<li class="chapter" data-level="10.9" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-first-pc"><i class="fa fa-check"></i><b>10.9</b> PCA: First PC</a></li>
<li class="chapter" data-level="10.10" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-first-pc-1"><i class="fa fa-check"></i><b>10.10</b> PCA: First PC</a></li>
<li class="chapter" data-level="10.11" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-second-pc"><i class="fa fa-check"></i><b>10.11</b> PCA: Second PC</a></li>
<li class="chapter" data-level="10.12" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#pca-how-many-pcs-to-use"><i class="fa fa-check"></i><b>10.12</b> PCA: How Many PCs to Use?</a></li>
<li class="chapter" data-level="10.13" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-61"><i class="fa fa-check"></i><b>10.13</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.14" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-62"><i class="fa fa-check"></i><b>10.14</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.15" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-63"><i class="fa fa-check"></i><b>10.15</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.16" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-64"><i class="fa fa-check"></i><b>10.16</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.17" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-65"><i class="fa fa-check"></i><b>10.17</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.18" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#principal-components-regression-pcr"><i class="fa fa-check"></i><b>10.18</b> Principal Components Regression (PCR)</a></li>
<li class="chapter" data-level="10.19" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#principal-components-regression-pcr-1"><i class="fa fa-check"></i><b>10.19</b> Principal Components Regression (PCR)</a></li>
<li class="chapter" data-level="10.20" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#clustering"><i class="fa fa-check"></i><b>10.20</b> Clustering</a></li>
<li class="chapter" data-level="10.21" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#clustering-applications"><i class="fa fa-check"></i><b>10.21</b> Clustering: Applications</a></li>
<li class="chapter" data-level="10.22" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering"><i class="fa fa-check"></i><b>10.22</b> K-Means Clustering</a></li>
<li class="chapter" data-level="10.23" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-1"><i class="fa fa-check"></i><b>10.23</b> K-Means Clustering</a></li>
<li class="chapter" data-level="10.24" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-2"><i class="fa fa-check"></i><b>10.24</b> K-Means Clustering</a></li>
<li class="chapter" data-level="10.25" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-formulation"><i class="fa fa-check"></i><b>10.25</b> K-Means Clustering Formulation</a></li>
<li class="chapter" data-level="10.26" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-algorithm"><i class="fa fa-check"></i><b>10.26</b> K-Means Clustering Algorithm</a></li>
<li class="chapter" data-level="10.27" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-algorithm-1"><i class="fa fa-check"></i><b>10.27</b> K-Means Clustering Algorithm</a></li>
<li class="chapter" data-level="10.28" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#k-means-clustering-algorithm-2"><i class="fa fa-check"></i><b>10.28</b> K-Means Clustering Algorithm</a></li>
<li class="chapter" data-level="10.29" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering"><i class="fa fa-check"></i><b>10.29</b> Hierarchical Clustering</a></li>
<li class="chapter" data-level="10.30" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering-1"><i class="fa fa-check"></i><b>10.30</b> Hierarchical Clustering</a></li>
<li class="chapter" data-level="10.31" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering-2"><i class="fa fa-check"></i><b>10.31</b> Hierarchical Clustering</a></li>
<li class="chapter" data-level="10.32" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering-types-of-linkage"><i class="fa fa-check"></i><b>10.32</b> Hierarchical Clustering: Types of Linkage</a></li>
<li class="chapter" data-level="10.33" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering-algorithm"><i class="fa fa-check"></i><b>10.33</b> Hierarchical Clustering Algorithm</a></li>
<li class="chapter" data-level="10.34" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#hierarchical-clustering-choice-of-dissimilarity-measure"><i class="fa fa-check"></i><b>10.34</b> Hierarchical Clustering: Choice of Dissimilarity Measure</a></li>
<li class="chapter" data-level="10.35" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#practical-issues-in-clustering"><i class="fa fa-check"></i><b>10.35</b> Practical Issues in Clustering</a></li>
<li class="chapter" data-level="10.36" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-66"><i class="fa fa-check"></i><b>10.36</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.37" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-67"><i class="fa fa-check"></i><b>10.37</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.38" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#your-turn-68"><i class="fa fa-check"></i><b>10.38</b> <span style="color:blue">Your Turn!!!</span></a></li>
<li class="chapter" data-level="10.39" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#to-sum-it-all-up"><i class="fa fa-check"></i><b>10.39</b> To Sum It All Up</a></li>
<li class="chapter" data-level="10.40" data-path="unsupervised-learning-1.html"><a href="unsupervised-learning-1.html#next-steps"><i class="fa fa-check"></i><b>10.40</b> Next Steps</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">208 Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-model-selection-and-regularization" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Linear Model Selection and Regularization<a href="linear-model-selection-and-regularization.html#linear-model-selection-and-regularization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The standard linear model,</p>
<p><img src="EFT/e6.1.png" width="60%" style="display: block; margin: auto;" /></p>
<ul>
<li><p><strong>Benefits</strong>: Simple, interpretable, often shows good predictive performance.</p></li>
<li><p><strong>Limitations</strong>:</p>
<ul>
<li><p><strong>Prediction Accuracy</strong>: If <span class="math inline">\(n\)</span> is not big (also when <span class="math inline">\(p&gt;n\)</span>), variance can be high resulting in overfitting and poor predictive performance.</p></li>
<li><p><strong>Model Interpretability</strong>: Irrelevant features lead to unnecessary model complexity.</p></li>
</ul></li>
</ul>
<div id="alternatives-to-least-squares" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Alternatives to Least Squares<a href="linear-model-selection-and-regularization.html#alternatives-to-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Extensions/Modifications/Improvements to Least Squares:</p>
<ul>
<li><p><strong>Subset Selection</strong>: Identify a subset of <span class="math inline">\(p\)</span> predictors and then fit a linear model using least squares.</p></li>
<li><p><strong>Shrinkage/Regularization</strong>: Fit a model using <span class="math inline">\(p\)</span> predictors, but shrink some of the estimated coefficients towards zero. Reduces variance and can also perform variable selection.</p></li>
<li><p><strong>Dimension Reduction</strong>: Project <span class="math inline">\(p\)</span> predictors onto a <span class="math inline">\(M\)</span>-dimensional subspace, where <span class="math inline">\(M&lt;p\)</span>. Achieved by computing <span class="math inline">\(M\)</span> different linear combinations or projections of the <span class="math inline">\(p\)</span> predictors. Fit a linear model using these <span class="math inline">\(M\)</span> predictors by least squares.</p></li>
</ul>
</div>
<div id="shrinkageregularization-methods" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Shrinkage/Regularization Methods<a href="linear-model-selection-and-regularization.html#shrinkageregularization-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fit a model containing all <span class="math inline">\(p\)</span> predictors using a technique that <strong>shrinks</strong> the coefficient estimates towards zero.</p>
<ul>
<li><p>Ridge Regression</p></li>
<li><p>Lasso</p></li>
</ul>
<p><strong>Shrinking the coefficient estimates significantly reduces their variance.</strong></p>
</div>
<div id="the-lasso" class="section level2 smaller hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> The Lasso<a href="linear-model-selection-and-regularization.html#the-lasso" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Acronym for <strong>Least Absolute Shrinkage and Selection Operator</strong>.</p>
<ul>
<li><strong>Standard Linear Model</strong></li>
</ul>
<p>Given a training dataset, for <span class="math inline">\(i=1,\ldots,n\)</span></p>
<p><span class="math display">\[y_i=\beta_0+\beta_1 x_{i1}+ \ldots + \beta_p x_{ip} + \epsilon_i = \beta_0 + \displaystyle \sum_{j=1}^p \beta_j x_{ij} + \epsilon_i\]</span></p>
<p><img src="EFT/e6.45.png" width="30%" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Lasso</strong></li>
</ul>
<!-- Lasso is a relatively recent alternative to ridge regression that overcomes the disadvantage. -->
<p><img src="EFT/e6.7.png" width="60%" style="display: block; margin: auto;" /></p>
<ul>
<li><p><span class="math inline">\(\lambda \displaystyle \sum_{j=1}^{p} |\beta_j|\)</span>: <strong>Shrinkage Penalty</strong></p></li>
<li><p><span class="math inline">\(\lambda \ge 0\)</span>: <strong>Tuning/Regularization Parameter</strong></p></li>
</ul>
<!-- ```{r , echo=FALSE, out.width = '25%'} -->
<!-- knitr::include_graphics("EFT/l1.png") -->
<!-- ``` -->
</div>
<div id="the-lasso-1" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> The Lasso<a href="linear-model-selection-and-regularization.html#the-lasso-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- * Like ridge regression, the lasso shrinks the coefficient estimates towards zero. -->
<!-- * However, in the case of the lasso, the $l_1$ penalty forces some of the coefficient estimates to be -->
<!-- exactly equal to zero when the tuning parameter $\lambda$ is sufficiently large. -->
<ul>
<li><p>This method not only shrinks the coefficient estimates towards zero, but also makes some of the coefficient estimates exactly equal to zero (when the tuning parameter <span class="math inline">\(\lambda\)</span> is sufficiently large).</p></li>
<li><p>Hence, the lasso performs <strong>variable selection</strong>.</p></li>
</ul>
<!-- much like best subset selection,  -->
<ul>
<li>We say that the lasso yields <strong>sparse models</strong>, that is, models that involve only a subset of the variables.</li>
</ul>
</div>
<div id="the-lasso-scaling-of-predictors" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> The Lasso: Scaling of Predictors<a href="linear-model-selection-and-regularization.html#the-lasso-scaling-of-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Standard least squares (regression) coefficient estimates are <strong>scale equivariant</strong>: multiplying <span class="math inline">\(X_j\)</span> by a constant <span class="math inline">\(c\)</span> simply leads to a scaling of the least squares coefficient estimates by a factor of <span class="math inline">\(1/c\)</span>. In other words, regardless of how the <span class="math inline">\(j^{th}\)</span> predictor is scaled, <span class="math inline">\(X_j \hat{\beta}_j\)</span> will remain the same.</p></li>
<li><p>In contrast, the lasso coefficient estimates can change substantially when multiplying a given predictor by a constant. Apply lasso after <strong>standardizing</strong> the predictors.</p></li>
</ul>
<p><img src="EFT/e6.6.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="the-lasso-implementation" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="linear-model-selection-and-regularization.html#cb193-1" aria-hidden="true" tabindex="-1"></a>ames <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;AmesHousing.rds&quot;</span>)   <span class="co"># load dataset</span></span>
<span id="cb193-2"><a href="linear-model-selection-and-regularization.html#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="linear-model-selection-and-regularization.html#cb193-3" aria-hidden="true" tabindex="-1"></a>ames<span class="sc">$</span>Overall_Qual <span class="ot">&lt;-</span> <span class="fu">factor</span>(ames<span class="sc">$</span>Overall_Qual, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Very_Poor&quot;</span>, <span class="st">&quot;Poor&quot;</span>, <span class="st">&quot;Fair&quot;</span>, <span class="st">&quot;Below_Average&quot;</span>,</span>
<span id="cb193-4"><a href="linear-model-selection-and-regularization.html#cb193-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;Average&quot;</span>, <span class="st">&quot;Above_Average&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Very_Good&quot;</span>,</span>
<span id="cb193-5"><a href="linear-model-selection-and-regularization.html#cb193-5" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;Excellent&quot;</span>, <span class="st">&quot;Very_Excellent&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="linear-model-selection-and-regularization.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data</span></span>
<span id="cb194-2"><a href="linear-model-selection-and-regularization.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="linear-model-selection-and-regularization.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb194-4"><a href="linear-model-selection-and-regularization.html#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="linear-model-selection-and-regularization.html#cb194-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> ames<span class="sc">$</span>Sale_Price, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)   <span class="co"># consider 70-30 split</span></span>
<span id="cb194-6"><a href="linear-model-selection-and-regularization.html#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="linear-model-selection-and-regularization.html#cb194-7" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> ames[index,]   <span class="co"># training data</span></span>
<span id="cb194-8"><a href="linear-model-selection-and-regularization.html#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="linear-model-selection-and-regularization.html#cb194-9" aria-hidden="true" tabindex="-1"></a>ames_test <span class="ot">&lt;-</span> ames[<span class="sc">-</span>index,]   <span class="co"># test data</span></span></code></pre></div>
</div>
<div id="the-lasso-implementation-1" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="linear-model-selection-and-regularization.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create recipe and blueprint, prepare and apply blueprint</span></span>
<span id="cb195-2"><a href="linear-model-selection-and-regularization.html#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="linear-model-selection-and-regularization.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb195-4"><a href="linear-model-selection-and-regularization.html#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="linear-model-selection-and-regularization.html#cb195-5" aria-hidden="true" tabindex="-1"></a>ames_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train)   <span class="co"># set up recipe</span></span>
<span id="cb195-6"><a href="linear-model-selection-and-regularization.html#cb195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-7"><a href="linear-model-selection-and-regularization.html#cb195-7" aria-hidden="true" tabindex="-1"></a>blueprint <span class="ot">&lt;-</span> ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="linear-model-selection-and-regularization.html#cb195-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(Street, Utilities, Pool_Area, Screen_Porch, Misc_Val) <span class="sc">%&gt;%</span>   <span class="co"># filter out zv/nzv predictors</span></span>
<span id="cb195-9"><a href="linear-model-selection-and-regularization.html#cb195-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(Gr_Liv_Area) <span class="sc">%&gt;%</span>                                    <span class="co"># impute missing entries</span></span>
<span id="cb195-10"><a href="linear-model-selection-and-regularization.html#cb195-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_integer</span>(Overall_Qual) <span class="sc">%&gt;%</span>                                       <span class="co"># numeric conversion of levels of the predictors</span></span>
<span id="cb195-11"><a href="linear-model-selection-and-regularization.html#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span>                      <span class="co"># center (subtract mean) all numeric predictors</span></span>
<span id="cb195-12"><a href="linear-model-selection-and-regularization.html#cb195-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span>                       <span class="co"># scale (divide by standard deviation) all numeric predictors</span></span>
<span id="cb195-13"><a href="linear-model-selection-and-regularization.html#cb195-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(Neighborhood, <span class="at">threshold =</span> <span class="fl">0.01</span>, <span class="at">other =</span> <span class="st">&quot;other&quot;</span>) <span class="sc">%&gt;%</span>      <span class="co"># lumping required predictors</span></span>
<span id="cb195-14"><a href="linear-model-selection-and-regularization.html#cb195-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="at">one_hot =</span> <span class="cn">TRUE</span>)                            <span class="co"># one-hot/dummy encode nominal categorical predictors</span></span>
<span id="cb195-15"><a href="linear-model-selection-and-regularization.html#cb195-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-16"><a href="linear-model-selection-and-regularization.html#cb195-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-17"><a href="linear-model-selection-and-regularization.html#cb195-17" aria-hidden="true" tabindex="-1"></a>prepare <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint, <span class="at">data =</span> ames_train)    <span class="co"># estimate feature engineering parameters based on training data</span></span>
<span id="cb195-18"><a href="linear-model-selection-and-regularization.html#cb195-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-19"><a href="linear-model-selection-and-regularization.html#cb195-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-20"><a href="linear-model-selection-and-regularization.html#cb195-20" aria-hidden="true" tabindex="-1"></a>baked_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> ames_train)   <span class="co"># apply the blueprint to training data for building final/optimal model</span></span>
<span id="cb195-21"><a href="linear-model-selection-and-regularization.html#cb195-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-22"><a href="linear-model-selection-and-regularization.html#cb195-22" aria-hidden="true" tabindex="-1"></a>baked_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> ames_test)    <span class="co"># apply the blueprint to test data for future use</span></span></code></pre></div>
</div>
<div id="the-lasso-implementation-2" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<p>Implement CV to tune the hyperparameter <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="linear-model-selection-and-regularization.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb196-2"><a href="linear-model-selection-and-regularization.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="linear-model-selection-and-regularization.html#cb196-3" aria-hidden="true" tabindex="-1"></a>cv_specs <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">repeats =</span> <span class="dv">5</span>)   <span class="co"># CV specifications</span></span>
<span id="cb196-4"><a href="linear-model-selection-and-regularization.html#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="linear-model-selection-and-regularization.html#cb196-5" aria-hidden="true" tabindex="-1"></a>lambda_grid <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>)   <span class="co"># grid of lambda values to search over</span></span>
<span id="cb196-6"><a href="linear-model-selection-and-regularization.html#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="linear-model-selection-and-regularization.html#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## Loaded glmnet 4.1-6</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="linear-model-selection-and-regularization.html#cb201-1" aria-hidden="true" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb201-2"><a href="linear-model-selection-and-regularization.html#cb201-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> ames_train,</span>
<span id="cb201-3"><a href="linear-model-selection-and-regularization.html#cb201-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;glmnet&quot;</span>,   <span class="co"># for lasso</span></span>
<span id="cb201-4"><a href="linear-model-selection-and-regularization.html#cb201-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> cv_specs,</span>
<span id="cb201-5"><a href="linear-model-selection-and-regularization.html#cb201-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lambda_grid),   <span class="co"># alpha = 1 implements lasso</span></span>
<span id="cb201-6"><a href="linear-model-selection-and-regularization.html#cb201-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;RMSE&quot;</span>)</span>
<span id="cb201-7"><a href="linear-model-selection-and-regularization.html#cb201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-8"><a href="linear-model-selection-and-regularization.html#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co"># results from the CV procedure</span></span>
<span id="cb201-9"><a href="linear-model-selection-and-regularization.html#cb201-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-10"><a href="linear-model-selection-and-regularization.html#cb201-10" aria-hidden="true" tabindex="-1"></a>lasso_cv<span class="sc">$</span>bestTune    <span class="co"># optimal lambda</span></span></code></pre></div>
<pre><code>##     alpha lambda
## 100     1   1000</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="linear-model-selection-and-regularization.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(lasso_cv<span class="sc">$</span>results<span class="sc">$</span>RMSE)   <span class="co"># RMSE for optimal lambda</span></span></code></pre></div>
<pre><code>## [1] 42263.95</code></pre>
</div>
<div id="the-lasso-implementation-3" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<p>Results from the CV procedure.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="linear-model-selection-and-regularization.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lasso_cv)   <span class="co"># lambda vs. RMSE plot</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-122-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="the-lasso-implementation-4" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<p>We will now build the optimal lasso model on the modified training data using the optimal <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="linear-model-selection-and-regularization.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create datasets required for &#39;glmnet&#39; function</span></span>
<span id="cb206-2"><a href="linear-model-selection-and-regularization.html#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="linear-model-selection-and-regularization.html#cb206-3" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> baked_train)[, <span class="sc">-</span><span class="dv">1</span>]   <span class="co"># training features without intercept</span></span>
<span id="cb206-4"><a href="linear-model-selection-and-regularization.html#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="linear-model-selection-and-regularization.html#cb206-5" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> baked_train<span class="sc">$</span>Sale_Price    <span class="co"># training response</span></span>
<span id="cb206-6"><a href="linear-model-selection-and-regularization.html#cb206-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-7"><a href="linear-model-selection-and-regularization.html#cb206-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> baked_test)[, <span class="sc">-</span><span class="dv">1</span>]   <span class="co"># test features without intercept</span></span>
<span id="cb206-8"><a href="linear-model-selection-and-regularization.html#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="linear-model-selection-and-regularization.html#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co"># build optimal lasso model</span></span>
<span id="cb206-10"><a href="linear-model-selection-and-regularization.html#cb206-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-11"><a href="linear-model-selection-and-regularization.html#cb206-11" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> X_train, <span class="at">y =</span> Y_train,</span>
<span id="cb206-12"><a href="linear-model-selection-and-regularization.html#cb206-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="dv">1</span>,                      <span class="co"># alpha = 1 builds lasso model</span></span>
<span id="cb206-13"><a href="linear-model-selection-and-regularization.html#cb206-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lambda =</span> lasso_cv<span class="sc">$</span>bestTune<span class="sc">$</span>lambda,   <span class="co"># using optimal lambda from CV</span></span>
<span id="cb206-14"><a href="linear-model-selection-and-regularization.html#cb206-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">standardize =</span> <span class="cn">FALSE</span>)     <span class="co"># we have already standardized during data preprocessing</span></span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="linear-model-selection-and-regularization.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain predictions and test set RMSE</span></span>
<span id="cb207-2"><a href="linear-model-selection-and-regularization.html#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="linear-model-selection-and-regularization.html#cb207-3" aria-hidden="true" tabindex="-1"></a>final_model_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newx =</span> X_test)    <span class="co"># obtain predictions</span></span>
<span id="cb207-4"><a href="linear-model-selection-and-regularization.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="linear-model-selection-and-regularization.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((final_model_preds <span class="sc">-</span> baked_test<span class="sc">$</span>Sale_Price)<span class="sc">^</span><span class="dv">2</span>))   <span class="co"># calculate test set RMSE</span></span></code></pre></div>
<pre><code>## [1] 30840.5</code></pre>
</div>
<div id="the-lasso-implementation-5" class="section level2 smaller hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<p>The coefficients for the optimal lasso model can be obtained from</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="linear-model-selection-and-regularization.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(final_model)    <span class="co"># estimated coefficients from final lasso model</span></span></code></pre></div>
<pre><code>## 58 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                s0
## (Intercept)                                           176064.4047
## Gr_Liv_Area                                             4818.3193
## Garage_Cars                                            10866.6279
## Garage_Area                                                .     
## Overall_Qual                                           34950.7772
## Lot_Area                                                2450.1548
## Lot_Frontage                                             196.4699
## Open_Porch_SF                                            416.8881
## TotRms_AbvGrd                                          -2617.0296
## First_Flr_SF                                           25444.3738
## Second_Flr_SF                                          17393.1449
## Year_Built                                              7404.4553
## Garage_Type_Attchd                                         .     
## Garage_Type_Basment                                        .     
## Garage_Type_BuiltIn                                        .     
## Garage_Type_CarPort                                        .     
## Garage_Type_Detchd                                         .     
## Garage_Type_More_Than_Two_Types                            .     
## Garage_Type_No_Garage                                      .     
## Neighborhood_North_Ames                                    .     
## Neighborhood_College_Creek                                 .     
## Neighborhood_Old_Town                                      .     
## Neighborhood_Edwards                                       .     
## Neighborhood_Somerset                                      .     
## Neighborhood_Northridge_Heights                        19267.6111
## Neighborhood_Gilbert                                       .     
## Neighborhood_Sawyer                                        .     
## Neighborhood_Northwest_Ames                                .     
## Neighborhood_Sawyer_West                                   .     
## Neighborhood_Mitchell                                      .     
## Neighborhood_Brookside                                     .     
## Neighborhood_Crawford                                      .     
## Neighborhood_Iowa_DOT_and_Rail_Road                        .     
## Neighborhood_Timberland                                    .     
## Neighborhood_Northridge                                13301.0524
## Neighborhood_Stone_Brook                                   .     
## Neighborhood_South_and_West_of_Iowa_State_University       .     
## Neighborhood_Clear_Creek                                   .     
## Neighborhood_Meadow_Village                                .     
## Neighborhood_Bloomington_Heights                           .     
## Neighborhood_Veenker                                       .     
## Neighborhood_other                                         .     
## MS_SubClass_One_Story_1946_and_Newer_All_Styles        12281.5841
## MS_SubClass_One_Story_1945_and_Older                       .     
## MS_SubClass_One_Story_with_Finished_Attic_All_Ages         .     
## MS_SubClass_One_and_Half_Story_Unfinished_All_Ages         .     
## MS_SubClass_One_and_Half_Story_Finished_All_Ages           .     
## MS_SubClass_Two_Story_1946_and_Newer                       .     
## MS_SubClass_Two_Story_1945_and_Older                       .     
## MS_SubClass_Two_and_Half_Story_All_Ages                    .     
## MS_SubClass_Split_or_Multilevel                            .     
## MS_SubClass_Split_Foyer                                    .     
## MS_SubClass_Duplex_All_Styles_and_Ages                     .     
## MS_SubClass_One_Story_PUD_1946_and_Newer                   .     
## MS_SubClass_One_and_Half_Story_PUD_All_Ages                .     
## MS_SubClass_Two_Story_PUD_1946_and_Newer                   .     
## MS_SubClass_PUD_Multilevel_Split_Level_Foyer               .     
## MS_SubClass_Two_Family_conversion_All_Styles_and_Ages      .</code></pre>
</div>
<div id="the-lasso-implementation-6" class="section level2 smaller hasAnchor" number="7.12">
<h2><span class="header-section-number">7.12</span> The Lasso: Implementation<a href="linear-model-selection-and-regularization.html#the-lasso-implementation-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="linear-model-selection-and-regularization.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variable importance</span></span>
<span id="cb211-2"><a href="linear-model-selection-and-regularization.html#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="linear-model-selection-and-regularization.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(<span class="at">object =</span> lasso_cv, <span class="at">num_features =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-126-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="your-turn-7" class="section level2 smaller hasAnchor" number="7.13">
<h2><span class="header-section-number">7.13</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will work with the <strong>Hitters.rds</strong> dataset. Please download the dataset from Canvas, upload it to Posit Cloud, and load it using the following code.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="linear-model-selection-and-regularization.html#cb212-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Hitters.rds&quot;</span>)   <span class="co"># load dataset</span></span></code></pre></div>
<p>The dataset contains baseball statistics from the 1986 and 1987 seasons. The task is to predict <code>Salary</code> using the rest of the variables in the dataset. Compare the performance (in terms of <strong>RMSE</strong>) of the following two models:</p>
<ul>
<li><p>A linear regression model;</p></li>
<li><p>A LASSO model chosen by CV. Consider the grid of possible <span class="math inline">\(\lambda\)</span> values as <code>lambda_grid &lt;- 10^seq(-2, 2, length = 100)</code>.</p></li>
</ul>
<p><strong>Perform the following tasks.</strong></p>
<ul>
<li><p>Investigate the dataset and complete any necessary tasks.</p></li>
<li><p>Split the data into training and test sets (80-20).</p></li>
<li><p>Perform required data preprocessing and create the blueprint. If using <code>step_dummy()</code>, set <code>one_hot = FALSE</code>. Prepare the blueprint on the training data. Obtain the modified training and test datasets.</p></li>
<li><p>Implement 5-fold CV repeated 5 times for each of the models above.</p></li>
<li><p>Report the optimal CV RMSE of each model. Report the optimal value of <span class="math inline">\(\lambda\)</span> for the LASSO model. Which model performs better in this situation?</p></li>
<li><p>Using the optimal model, obtain predictions on the test set. Calculate and report the test set RMSE.</p></li>
<li><p>Using the optimal model, obtain variable importance measures for the features.</p></li>
</ul>
</div>
<div id="your-turn-8" class="section level2 smaller hasAnchor" number="7.14">
<h2><span class="header-section-number">7.14</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="linear-model-selection-and-regularization.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Hitters)</span></code></pre></div>
<pre><code>## Rows: 263
## Columns: 20
## $ AtBat     &lt;int&gt; 315, 479, 496, 321, 594, 185, 298, 323, 401, 574, 202, 418, 
## $ Hits      &lt;int&gt; 81, 130, 141, 87, 169, 37, 73, 81, 92, 159, 53, 113, 60, 43,
## $ HmRun     &lt;int&gt; 7, 18, 20, 10, 4, 1, 0, 6, 17, 21, 4, 13, 0, 7, 20, 2, 8, 16
## $ Runs      &lt;int&gt; 24, 66, 65, 39, 74, 23, 24, 26, 49, 107, 31, 48, 30, 29, 89,
## $ RBI       &lt;int&gt; 38, 72, 78, 42, 51, 8, 24, 32, 66, 75, 26, 61, 11, 27, 75, 8
## $ Walks     &lt;int&gt; 39, 76, 37, 30, 35, 21, 7, 8, 65, 59, 27, 47, 22, 30, 73, 15
## $ Years     &lt;int&gt; 14, 3, 11, 2, 11, 2, 3, 2, 13, 10, 9, 4, 6, 13, 15, 5, 8, 1,
## $ CAtBat    &lt;int&gt; 3449, 1624, 5628, 396, 4408, 214, 509, 341, 5206, 4631, 1876
## $ CHits     &lt;int&gt; 835, 457, 1575, 101, 1133, 42, 108, 86, 1332, 1300, 467, 392
## $ CHmRun    &lt;int&gt; 69, 63, 225, 12, 19, 1, 0, 6, 253, 90, 15, 41, 4, 36, 177, 5
## $ CRuns     &lt;int&gt; 321, 224, 828, 48, 501, 30, 41, 32, 784, 702, 192, 205, 309,
## $ CRBI      &lt;int&gt; 414, 266, 838, 46, 336, 9, 37, 34, 890, 504, 186, 204, 103, 
## $ CWalks    &lt;int&gt; 375, 263, 354, 33, 194, 24, 12, 8, 866, 488, 161, 203, 207, 
## $ League    &lt;fct&gt; N, A, N, N, A, N, A, N, A, A, N, N, A, N, N, A, N, N, A, N, 
## $ Division  &lt;fct&gt; W, W, E, E, W, E, W, W, E, E, W, E, E, E, W, W, W, E, W, W, 
## $ PutOuts   &lt;int&gt; 632, 880, 200, 805, 282, 76, 121, 143, 0, 238, 304, 211, 121
## $ Assists   &lt;int&gt; 43, 82, 11, 40, 421, 127, 283, 290, 0, 445, 45, 11, 151, 45,
## $ Errors    &lt;int&gt; 10, 14, 3, 4, 25, 7, 9, 19, 0, 22, 11, 7, 6, 8, 10, 16, 2, 5
## $ Salary    &lt;dbl&gt; 475.000, 480.000, 500.000, 91.500, 750.000, 70.000, 100.000,
## $ NewLeague &lt;fct&gt; N, A, N, N, A, A, A, N, A, A, N, N, A, N, N, A, N, N, N, N, </code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="linear-model-selection-and-regularization.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># categorical feature: League, Division, NewLeague (all nominal)</span></span>
<span id="cb215-2"><a href="linear-model-selection-and-regularization.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rest of the features are numerical</span></span></code></pre></div>
</div>
<div id="your-turn-9" class="section level2 smaller hasAnchor" number="7.15">
<h2><span class="header-section-number">7.15</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="linear-model-selection-and-regularization.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(Hitters))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="linear-model-selection-and-regularization.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no missing entries</span></span></code></pre></div>
</div>
<div id="your-turn-10" class="section level2 smaller hasAnchor" number="7.16">
<h2><span class="header-section-number">7.16</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="linear-model-selection-and-regularization.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Hitters)</span></code></pre></div>
<pre><code>##      AtBat            Hits           HmRun            Runs       
##  Min.   : 19.0   Min.   :  1.0   Min.   : 0.00   Min.   :  0.00  
##  1st Qu.:282.5   1st Qu.: 71.5   1st Qu.: 5.00   1st Qu.: 33.50  
##  Median :413.0   Median :103.0   Median : 9.00   Median : 52.00  
##  Mean   :403.6   Mean   :107.8   Mean   :11.62   Mean   : 54.75  
##  3rd Qu.:526.0   3rd Qu.:141.5   3rd Qu.:18.00   3rd Qu.: 73.00  
##  Max.   :687.0   Max.   :238.0   Max.   :40.00   Max.   :130.00  
##       RBI             Walks            Years            CAtBat       
##  Min.   :  0.00   Min.   :  0.00   Min.   : 1.000   Min.   :   19.0  
##  1st Qu.: 30.00   1st Qu.: 23.00   1st Qu.: 4.000   1st Qu.:  842.5  
##  Median : 47.00   Median : 37.00   Median : 6.000   Median : 1931.0  
##  Mean   : 51.49   Mean   : 41.11   Mean   : 7.312   Mean   : 2657.5  
##  3rd Qu.: 71.00   3rd Qu.: 57.00   3rd Qu.:10.000   3rd Qu.: 3890.5  
##  Max.   :121.00   Max.   :105.00   Max.   :24.000   Max.   :14053.0  
##      CHits            CHmRun           CRuns             CRBI       
##  Min.   :   4.0   Min.   :  0.00   Min.   :   2.0   Min.   :   3.0  
##  1st Qu.: 212.0   1st Qu.: 15.00   1st Qu.: 105.5   1st Qu.:  95.0  
##  Median : 516.0   Median : 40.00   Median : 250.0   Median : 230.0  
##  Mean   : 722.2   Mean   : 69.24   Mean   : 361.2   Mean   : 330.4  
##  3rd Qu.:1054.0   3rd Qu.: 92.50   3rd Qu.: 497.5   3rd Qu.: 424.5  
##  Max.   :4256.0   Max.   :548.00   Max.   :2165.0   Max.   :1659.0  
##      CWalks       League  Division    PutOuts          Assists     
##  Min.   :   1.0   A:139   E:129    Min.   :   0.0   Min.   :  0.0  
##  1st Qu.:  71.0   N:124   W:134    1st Qu.: 113.5   1st Qu.:  8.0  
##  Median : 174.0                    Median : 224.0   Median : 45.0  
##  Mean   : 260.3                    Mean   : 290.7   Mean   :118.8  
##  3rd Qu.: 328.5                    3rd Qu.: 322.5   3rd Qu.:192.0  
##  Max.   :1566.0                    Max.   :1377.0   Max.   :492.0  
##      Errors           Salary       NewLeague
##  Min.   : 0.000   Min.   :  67.5   A:141    
##  1st Qu.: 3.000   1st Qu.: 190.0   N:122    
##  Median : 7.000   Median : 425.0            
##  Mean   : 8.593   Mean   : 535.9            
##  3rd Qu.:13.000   3rd Qu.: 750.0            
##  Max.   :32.000   Max.   :2460.0</code></pre>
</div>
<div id="your-turn-11" class="section level2 smaller hasAnchor" number="7.17">
<h2><span class="header-section-number">7.17</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="linear-model-selection-and-regularization.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nearZeroVar</span>(Hitters, <span class="at">saveMetrics =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##           freqRatio percentUnique zeroVar   nzv
## AtBat      1.000000    79.4676806   FALSE FALSE
## Hits       1.200000    49.4296578   FALSE FALSE
## HmRun      1.058824    13.3079848   FALSE FALSE
## Runs       1.428571    34.9809886   FALSE FALSE
## RBI        1.125000    35.7414449   FALSE FALSE
## Walks      1.222222    33.0798479   FALSE FALSE
## Years      1.000000     7.9847909   FALSE FALSE
## CAtBat     1.000000    97.7186312   FALSE FALSE
## CHits      1.500000    91.6349810   FALSE FALSE
## CHmRun     1.000000    49.0494297   FALSE FALSE
## CRuns      1.000000    85.9315589   FALSE FALSE
## CRBI       1.333333    85.9315589   FALSE FALSE
## CWalks     1.000000    78.7072243   FALSE FALSE
## League     1.120968     0.7604563   FALSE FALSE
## Division   1.038760     0.7604563   FALSE FALSE
## PutOuts    2.750000    75.6653992   FALSE FALSE
## Assists    1.000000    55.1330798   FALSE FALSE
## Errors     1.500000    11.0266160   FALSE FALSE
## Salary     1.333333    57.0342205   FALSE FALSE
## NewLeague  1.155738     0.7604563   FALSE FALSE</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="linear-model-selection-and-regularization.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no zv/nzv features in the original data</span></span></code></pre></div>
</div>
<div id="your-turn-12" class="section level2 hasAnchor" number="7.18">
<h2><span class="header-section-number">7.18</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="linear-model-selection-and-regularization.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data</span></span>
<span id="cb224-2"><a href="linear-model-selection-and-regularization.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="linear-model-selection-and-regularization.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb224-4"><a href="linear-model-selection-and-regularization.html#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="linear-model-selection-and-regularization.html#cb224-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(Hitters<span class="sc">$</span>Salary, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb224-6"><a href="linear-model-selection-and-regularization.html#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="linear-model-selection-and-regularization.html#cb224-7" aria-hidden="true" tabindex="-1"></a>Hitters_train <span class="ot">&lt;-</span> Hitters[index,]    <span class="co"># training set</span></span>
<span id="cb224-8"><a href="linear-model-selection-and-regularization.html#cb224-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-9"><a href="linear-model-selection-and-regularization.html#cb224-9" aria-hidden="true" tabindex="-1"></a>Hitters_test <span class="ot">&lt;-</span> Hitters[<span class="sc">-</span>index,]   <span class="co"># test set</span></span></code></pre></div>
</div>
<div id="your-turn-13" class="section level2 smaller hasAnchor" number="7.19">
<h2><span class="header-section-number">7.19</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="linear-model-selection-and-regularization.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nearZeroVar</span>(Hitters_train, <span class="at">saveMetrics =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##           freqRatio percentUnique zeroVar   nzv
## AtBat      1.000000    82.5471698   FALSE FALSE
## Hits       1.250000    57.0754717   FALSE FALSE
## HmRun      1.000000    16.0377358   FALSE FALSE
## Runs       1.142857    39.1509434   FALSE FALSE
## RBI        1.142857    40.0943396   FALSE FALSE
## Walks      1.000000    37.7358491   FALSE FALSE
## Years      1.136364     9.4339623   FALSE FALSE
## CAtBat     1.000000    97.6415094   FALSE FALSE
## CHits      1.500000    91.9811321   FALSE FALSE
## CHmRun     1.000000    54.2452830   FALSE FALSE
## CRuns      1.000000    90.0943396   FALSE FALSE
## CRBI       1.333333    88.2075472   FALSE FALSE
## CWalks     1.000000    78.3018868   FALSE FALSE
## League     1.163265     0.9433962   FALSE FALSE
## Division   1.078431     0.9433962   FALSE FALSE
## PutOuts    2.000000    80.6603774   FALSE FALSE
## Assists    1.090909    59.9056604   FALSE FALSE
## Errors     1.388889    13.2075472   FALSE FALSE
## Salary     1.166667    60.3773585   FALSE FALSE
## NewLeague  1.231579     0.9433962   FALSE FALSE</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="linear-model-selection-and-regularization.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no zv/nzv features in the training data</span></span></code></pre></div>
</div>
<div id="your-turn-14" class="section level2 hasAnchor" number="7.20">
<h2><span class="header-section-number">7.20</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="linear-model-selection-and-regularization.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb228-2"><a href="linear-model-selection-and-regularization.html#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="linear-model-selection-and-regularization.html#cb228-3" aria-hidden="true" tabindex="-1"></a>Hitters_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Salary <span class="sc">~</span>. , <span class="at">data =</span> Hitters_train)   <span class="co"># create recipe</span></span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="linear-model-selection-and-regularization.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb229-2"><a href="linear-model-selection-and-regularization.html#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="linear-model-selection-and-regularization.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create blueprint with feature engineering steps</span></span>
<span id="cb229-4"><a href="linear-model-selection-and-regularization.html#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="linear-model-selection-and-regularization.html#cb229-5" aria-hidden="true" tabindex="-1"></a>blueprint <span class="ot">&lt;-</span> Hitters_recipe <span class="sc">%&gt;%</span></span>
<span id="cb229-6"><a href="linear-model-selection-and-regularization.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span>      <span class="co"># center numerical features</span></span>
<span id="cb229-7"><a href="linear-model-selection-and-regularization.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span>       <span class="co"># scale numerical features</span></span>
<span id="cb229-8"><a href="linear-model-selection-and-regularization.html#cb229-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="at">one_hot =</span> <span class="cn">FALSE</span>)     <span class="co"># dummy encode nominal features</span></span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="linear-model-selection-and-regularization.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb230-2"><a href="linear-model-selection-and-regularization.html#cb230-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-3"><a href="linear-model-selection-and-regularization.html#cb230-3" aria-hidden="true" tabindex="-1"></a>prepare <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint, <span class="at">data =</span> Hitters_train)    <span class="co"># estimate feature engineering parameters based on training data</span></span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="linear-model-selection-and-regularization.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb231-2"><a href="linear-model-selection-and-regularization.html#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="linear-model-selection-and-regularization.html#cb231-3" aria-hidden="true" tabindex="-1"></a>baked_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> Hitters_train)   <span class="co"># apply the blueprint to training data</span></span>
<span id="cb231-4"><a href="linear-model-selection-and-regularization.html#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="linear-model-selection-and-regularization.html#cb231-5" aria-hidden="true" tabindex="-1"></a>baked_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> Hitters_test)   <span class="co"># apply the blueprint to test data</span></span></code></pre></div>
</div>
<div id="your-turn-15" class="section level2 hasAnchor" number="7.21">
<h2><span class="header-section-number">7.21</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="linear-model-selection-and-regularization.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb232-2"><a href="linear-model-selection-and-regularization.html#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="linear-model-selection-and-regularization.html#cb232-3" aria-hidden="true" tabindex="-1"></a>cv_specs <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">repeats =</span> <span class="dv">5</span>)   <span class="co"># CV specifications</span></span></code></pre></div>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="linear-model-selection-and-regularization.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb233-2"><a href="linear-model-selection-and-regularization.html#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="linear-model-selection-and-regularization.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with linear regression</span></span>
<span id="cb233-4"><a href="linear-model-selection-and-regularization.html#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="linear-model-selection-and-regularization.html#cb233-5" aria-hidden="true" tabindex="-1"></a>lm_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb233-6"><a href="linear-model-selection-and-regularization.html#cb233-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> Hitters_train,</span>
<span id="cb233-7"><a href="linear-model-selection-and-regularization.html#cb233-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb233-8"><a href="linear-model-selection-and-regularization.html#cb233-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> cv_specs,</span>
<span id="cb233-9"><a href="linear-model-selection-and-regularization.html#cb233-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">metric =</span> <span class="st">&quot;RMSE&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="linear-model-selection-and-regularization.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb234-2"><a href="linear-model-selection-and-regularization.html#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="linear-model-selection-and-regularization.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with LASSO</span></span>
<span id="cb234-4"><a href="linear-model-selection-and-regularization.html#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="linear-model-selection-and-regularization.html#cb234-5" aria-hidden="true" tabindex="-1"></a>lambda_grid <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">100</span>)    <span class="co"># grid of lambda values</span></span>
<span id="cb234-6"><a href="linear-model-selection-and-regularization.html#cb234-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-7"><a href="linear-model-selection-and-regularization.html#cb234-7" aria-hidden="true" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb234-8"><a href="linear-model-selection-and-regularization.html#cb234-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Hitters_train,</span>
<span id="cb234-9"><a href="linear-model-selection-and-regularization.html#cb234-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;glmnet&quot;</span>,</span>
<span id="cb234-10"><a href="linear-model-selection-and-regularization.html#cb234-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> cv_specs,</span>
<span id="cb234-11"><a href="linear-model-selection-and-regularization.html#cb234-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lambda_grid),</span>
<span id="cb234-12"><a href="linear-model-selection-and-regularization.html#cb234-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;RMSE&quot;</span>)</span></code></pre></div>
</div>
<div id="your-turn-16" class="section level2 hasAnchor" number="7.22">
<h2><span class="header-section-number">7.22</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="linear-model-selection-and-regularization.html#cb235-1" aria-hidden="true" tabindex="-1"></a>lm_cv<span class="sc">$</span>results<span class="sc">$</span>RMSE   <span class="co"># CV RMSE for linear regression model</span></span></code></pre></div>
<pre><code>## [1] 301.3199</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="linear-model-selection-and-regularization.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(lasso_cv<span class="sc">$</span>results<span class="sc">$</span>RMSE)    <span class="co"># CV RMSE for optimal LASSO</span></span></code></pre></div>
<pre><code>## [1] 295.07</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="linear-model-selection-and-regularization.html#cb239-1" aria-hidden="true" tabindex="-1"></a>lasso_cv<span class="sc">$</span>bestTune<span class="sc">$</span>lambda     <span class="co"># optimal lambda</span></span></code></pre></div>
<pre><code>## [1] 15.55676</code></pre>
</div>
<div id="your-turn-17" class="section level2 hasAnchor" number="7.23">
<h2><span class="header-section-number">7.23</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-17" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="linear-model-selection-and-regularization.html#cb241-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> baked_train)[, <span class="sc">-</span><span class="dv">1</span>]   <span class="co"># training features without intercept</span></span>
<span id="cb241-2"><a href="linear-model-selection-and-regularization.html#cb241-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-3"><a href="linear-model-selection-and-regularization.html#cb241-3" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> baked_train<span class="sc">$</span>Salary    <span class="co"># training response</span></span>
<span id="cb241-4"><a href="linear-model-selection-and-regularization.html#cb241-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-5"><a href="linear-model-selection-and-regularization.html#cb241-5" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Salary <span class="sc">~</span> ., <span class="at">data =</span> baked_test)[, <span class="sc">-</span><span class="dv">1</span>]   <span class="co"># test features without intercept</span></span>
<span id="cb241-6"><a href="linear-model-selection-and-regularization.html#cb241-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-7"><a href="linear-model-selection-and-regularization.html#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="co"># build optimal lasso model</span></span>
<span id="cb241-8"><a href="linear-model-selection-and-regularization.html#cb241-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-9"><a href="linear-model-selection-and-regularization.html#cb241-9" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> X_train, <span class="at">y =</span> Y_train,</span>
<span id="cb241-10"><a href="linear-model-selection-and-regularization.html#cb241-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha =</span> <span class="dv">1</span>,                      <span class="co"># alpha = 1 builds lasso model</span></span>
<span id="cb241-11"><a href="linear-model-selection-and-regularization.html#cb241-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lambda =</span> lasso_cv<span class="sc">$</span>bestTune<span class="sc">$</span>lambda,   <span class="co"># using optimal lambda from CV</span></span>
<span id="cb241-12"><a href="linear-model-selection-and-regularization.html#cb241-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">standardize =</span> <span class="cn">FALSE</span>)     <span class="co"># we have already standardized during data preprocessing</span></span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="linear-model-selection-and-regularization.html#cb242-1" aria-hidden="true" tabindex="-1"></a>final_model_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newx =</span> X_test)    <span class="co"># obtain predictions</span></span>
<span id="cb242-2"><a href="linear-model-selection-and-regularization.html#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="linear-model-selection-and-regularization.html#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((final_model_preds <span class="sc">-</span> baked_test<span class="sc">$</span>Salary)<span class="sc">^</span><span class="dv">2</span>))   <span class="co"># calculate test set RMSE</span></span></code></pre></div>
<pre><code>## [1] 510.4167</code></pre>
</div>
<div id="your-turn-18" class="section level2 smaller hasAnchor" number="7.24">
<h2><span class="header-section-number">7.24</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-18" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="linear-model-selection-and-regularization.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(<span class="at">object =</span> lasso_cv, <span class="at">num_features =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-144-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="multivariate-adaptive-regression-splines-mars" class="section level2 hasAnchor" number="7.25">
<h2><span class="header-section-number">7.25</span> Multivariate Adaptive Regression Splines (MARS)<a href="linear-model-selection-and-regularization.html#multivariate-adaptive-regression-splines-mars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multivariate Adaptive Regression Splines (MARS) capture the nonlinear relationships in the data by assessing <strong>cutpoints (knots)</strong>. The procedure assesses each data point for each predictor as a knot and creates a <strong>piecewise linear regression model</strong> with the candidate feature(s).</p>
<p>This procedure continues until many knots are found, producing a (potentially) highly non-linear prediction equation. Once the full set of knots has been identified, knots that do not contribute significantly to predictive accuracy can be sequentially removed. This process is known as <strong>pruning</strong> .</p>
<p>There are two tuning parameters associated with our MARS model:</p>
<ul>
<li><p>the maximum degree of interactions, and</p></li>
<li><p>the number of terms retained in the final model after pruning.</p></li>
</ul>
<p>We can use CV to identify the optimal combination of these tuning parameters .</p>
</div>
<div id="mars-geometry" class="section level2 hasAnchor" number="7.26">
<h2><span class="header-section-number">7.26</span> MARS: Geometry<a href="linear-model-selection-and-regularization.html#mars-geometry" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-145"></span>
<img src="EFT/MARS.jpg" alt="Adapted from Hands-on Machine Learning with R, Bradley Boehmke &amp; Brandon Greenwell" width="80%" />
<p class="caption">
Figure 7.1: Adapted from Hands-on Machine Learning with R, Bradley Boehmke &amp; Brandon Greenwell
</p>
</div>
</div>
<div id="mars-implementation" class="section level2 hasAnchor" number="7.27">
<h2><span class="header-section-number">7.27</span> MARS: Implementation<a href="linear-model-selection-and-regularization.html#mars-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="linear-model-selection-and-regularization.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data splitting and preprocessing already done in the previous slides</span></span>
<span id="cb245-2"><a href="linear-model-selection-and-regularization.html#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="linear-model-selection-and-regularization.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb245-4"><a href="linear-model-selection-and-regularization.html#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="linear-model-selection-and-regularization.html#cb245-5" aria-hidden="true" tabindex="-1"></a>cv_specs <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">repeats =</span> <span class="dv">5</span>)   <span class="co"># CV specifications</span></span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="linear-model-selection-and-regularization.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(earth)    <span class="co"># for MARS technique</span></span></code></pre></div>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## Loading required package: plotmo</code></pre>
<pre><code>## Loading required package: plotrix</code></pre>
<pre><code>## Loading required package: TeachingDemos</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="linear-model-selection-and-regularization.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb251-2"><a href="linear-model-selection-and-regularization.html#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="linear-model-selection-and-regularization.html#cb251-3" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">nprune =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">10</span>))   <span class="co"># grid of tuning parameters</span></span>
<span id="cb251-4"><a href="linear-model-selection-and-regularization.html#cb251-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-5"><a href="linear-model-selection-and-regularization.html#cb251-5" aria-hidden="true" tabindex="-1"></a>mars_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb251-6"><a href="linear-model-selection-and-regularization.html#cb251-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> ames_train,</span>
<span id="cb251-7"><a href="linear-model-selection-and-regularization.html#cb251-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;earth&quot;</span>,</span>
<span id="cb251-8"><a href="linear-model-selection-and-regularization.html#cb251-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> cv_specs,</span>
<span id="cb251-9"><a href="linear-model-selection-and-regularization.html#cb251-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tuneGrid =</span> param_grid,</span>
<span id="cb251-10"><a href="linear-model-selection-and-regularization.html#cb251-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;RMSE&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 493 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 495 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 494 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;

## Warning in cuts[nterm, ipred] == 0 &amp;&amp; !is.null(xrange) &amp;&amp; xrange[1, ipred] == :
## &#39;length(x) = 496 &gt; 1&#39; in coercion to &#39;logical(1)&#39;</code></pre>
<pre><code>## Warning in train_rec(rec = x, dat = data, info = trainInfo, method = models, :
## There were missing values in resampled performance measures.</code></pre>
</div>
<div id="mars-implementation-1" class="section level2 hasAnchor" number="7.28">
<h2><span class="header-section-number">7.28</span> MARS: Implementation<a href="linear-model-selection-and-regularization.html#mars-implementation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="linear-model-selection-and-regularization.html#cb259-1" aria-hidden="true" tabindex="-1"></a>mars_cv<span class="sc">$</span>bestTune   <span class="co"># optimal tuning parameters</span></span></code></pre></div>
<pre><code>##   nprune degree
## 2     12      1</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="linear-model-selection-and-regularization.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mars_cv<span class="sc">$</span>results<span class="sc">$</span>RMSE)   <span class="co"># optimal CV RMSE</span></span></code></pre></div>
<pre><code>## [1] 43190.54</code></pre>
</div>
<div id="mars-implementation-2" class="section level2 hasAnchor" number="7.29">
<h2><span class="header-section-number">7.29</span> MARS: Implementation<a href="linear-model-selection-and-regularization.html#mars-implementation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="linear-model-selection-and-regularization.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit final optimal model</span></span>
<span id="cb263-2"><a href="linear-model-selection-and-regularization.html#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="linear-model-selection-and-regularization.html#cb263-3" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">earth</span>(Sale_Price <span class="sc">~</span> .,</span>
<span id="cb263-4"><a href="linear-model-selection-and-regularization.html#cb263-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> baked_train,</span>
<span id="cb263-5"><a href="linear-model-selection-and-regularization.html#cb263-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">degree =</span> mars_cv<span class="sc">$</span>bestTune<span class="sc">$</span>degree,</span>
<span id="cb263-6"><a href="linear-model-selection-and-regularization.html#cb263-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nprune =</span> mars_cv<span class="sc">$</span>bestTune<span class="sc">$</span>nprune)</span></code></pre></div>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="linear-model-selection-and-regularization.html#cb264-1" aria-hidden="true" tabindex="-1"></a>final_model_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newdata =</span> baked_test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)   <span class="co"># obtain predictions</span></span>
<span id="cb264-2"><a href="linear-model-selection-and-regularization.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="linear-model-selection-and-regularization.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((final_model_preds <span class="sc">-</span> baked_test<span class="sc">$</span>Sale_Price)<span class="sc">^</span><span class="dv">2</span>))   <span class="co"># test RMSE</span></span></code></pre></div>
<pre><code>## [1] 29057.4</code></pre>
</div>
<div id="mars-implementation-3" class="section level2 hasAnchor" number="7.30">
<h2><span class="header-section-number">7.30</span> MARS: Implementation<a href="linear-model-selection-and-regularization.html#mars-implementation-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="linear-model-selection-and-regularization.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_model)</span></code></pre></div>
<pre><code>## Call: earth(formula=Sale_Price~., data=baked_train,
##             degree=mars_cv$bestTune$degree, nprune=mars_cv$bestTune$nprune)
## 
##                                        coefficients
## (Intercept)                              185460.891
## MS_SubClass_Duplex_All_Styles_and_Ages   -34415.007
## h(0.628157-Overall_Qual)                 -16973.775
## h(Overall_Qual-0.628157)                  86687.352
## h(-0.56119-Lot_Area)                     -46313.234
## h(Lot_Area- -0.56119)                      5775.321
## h(First_Flr_SF-1.81938)                  196633.878
## h(2.22339-First_Flr_SF)                  -22222.077
## h(First_Flr_SF-2.22339)                 -254800.210
## h(Second_Flr_SF-0.502964)                 38210.357
## h(Second_Flr_SF-2.25174)                  72488.093
## h(Year_Built- -1.83161)                   18090.264
## 
## Selected 12 of 27 terms, and 6 of 57 predictors (nprune=12)
## Termination condition: RSq changed by less than 0.001 at 27 terms
## Importance: Overall_Qual, First_Flr_SF, Second_Flr_SF, Year_Built, ...
## Number of terms at each degree of interaction: 1 11 (additive model)
## GCV 881846643    RSS 505171129102    GRSq 0.8817599    RSq 0.8900416</code></pre>
</div>
<div id="mars-implementation-4" class="section level2 smaller hasAnchor" number="7.31">
<h2><span class="header-section-number">7.31</span> MARS: Implementation<a href="linear-model-selection-and-regularization.html#mars-implementation-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="linear-model-selection-and-regularization.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(<span class="at">object =</span> mars_cv, <span class="at">num_features =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="mars" class="section level2 hasAnchor" number="7.32">
<h2><span class="header-section-number">7.32</span> MARS<a href="linear-model-selection-and-regularization.html#mars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Advantages</strong></p>
<ul>
<li><p>MARS can handle mixed types of features (quantitative and qualitative).</p></li>
<li><p>MARS also requires minimal feature engineering (missing values need to be imputed) and performs automated feature selection.</p></li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>MARS models are typically slower to train.</li>
</ul>
</div>
<div id="mars-without-feature-engineering-implementation" class="section level2 smaller hasAnchor" number="7.33">
<h2><span class="header-section-number">7.33</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="linear-model-selection-and-regularization.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create recipe and blueprint, prepare and apply blueprint</span></span>
<span id="cb269-2"><a href="linear-model-selection-and-regularization.html#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="linear-model-selection-and-regularization.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb269-4"><a href="linear-model-selection-and-regularization.html#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="linear-model-selection-and-regularization.html#cb269-5" aria-hidden="true" tabindex="-1"></a>ames_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train)   <span class="co"># set up recipe</span></span>
<span id="cb269-6"><a href="linear-model-selection-and-regularization.html#cb269-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-7"><a href="linear-model-selection-and-regularization.html#cb269-7" aria-hidden="true" tabindex="-1"></a>blueprint_new <span class="ot">&lt;-</span> ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb269-8"><a href="linear-model-selection-and-regularization.html#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(Gr_Liv_Area)                                     <span class="co"># impute missing entries</span></span>
<span id="cb269-9"><a href="linear-model-selection-and-regularization.html#cb269-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-10"><a href="linear-model-selection-and-regularization.html#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="linear-model-selection-and-regularization.html#cb269-11" aria-hidden="true" tabindex="-1"></a>prepare <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint_new, <span class="at">data =</span> ames_train)    <span class="co"># estimate feature engineering parameters based on training data</span></span>
<span id="cb269-12"><a href="linear-model-selection-and-regularization.html#cb269-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-13"><a href="linear-model-selection-and-regularization.html#cb269-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-14"><a href="linear-model-selection-and-regularization.html#cb269-14" aria-hidden="true" tabindex="-1"></a>baked_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> ames_train)   <span class="co"># apply the blueprint to training data for building final/optimal model</span></span>
<span id="cb269-15"><a href="linear-model-selection-and-regularization.html#cb269-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-16"><a href="linear-model-selection-and-regularization.html#cb269-16" aria-hidden="true" tabindex="-1"></a>baked_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> ames_test)    <span class="co"># apply the blueprint to test data for future use</span></span></code></pre></div>
</div>
<div id="mars-without-feature-engineering-implementation-1" class="section level2 smaller hasAnchor" number="7.34">
<h2><span class="header-section-number">7.34</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="linear-model-selection-and-regularization.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data splitting and preprocessing already done in the previous slides</span></span>
<span id="cb270-2"><a href="linear-model-selection-and-regularization.html#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="linear-model-selection-and-regularization.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb270-4"><a href="linear-model-selection-and-regularization.html#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="linear-model-selection-and-regularization.html#cb270-5" aria-hidden="true" tabindex="-1"></a>cv_specs <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">repeats =</span> <span class="dv">5</span>)   <span class="co"># CV specifications</span></span></code></pre></div>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="linear-model-selection-and-regularization.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(earth)    <span class="co"># for MARS technique</span></span>
<span id="cb271-2"><a href="linear-model-selection-and-regularization.html#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="linear-model-selection-and-regularization.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb271-4"><a href="linear-model-selection-and-regularization.html#cb271-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-5"><a href="linear-model-selection-and-regularization.html#cb271-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">nprune =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">10</span>))   <span class="co"># grid of tuning parameters</span></span>
<span id="cb271-6"><a href="linear-model-selection-and-regularization.html#cb271-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-7"><a href="linear-model-selection-and-regularization.html#cb271-7" aria-hidden="true" tabindex="-1"></a>mars_cv_new <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint_new,</span>
<span id="cb271-8"><a href="linear-model-selection-and-regularization.html#cb271-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> ames_train,</span>
<span id="cb271-9"><a href="linear-model-selection-and-regularization.html#cb271-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;earth&quot;</span>,</span>
<span id="cb271-10"><a href="linear-model-selection-and-regularization.html#cb271-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> cv_specs,</span>
<span id="cb271-11"><a href="linear-model-selection-and-regularization.html#cb271-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tuneGrid =</span> param_grid,</span>
<span id="cb271-12"><a href="linear-model-selection-and-regularization.html#cb271-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;RMSE&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in train_rec(rec = x, dat = data, info = trainInfo, method = models, :
## There were missing values in resampled performance measures.</code></pre>
</div>
<div id="mars-without-feature-engineering-implementation-2" class="section level2 smaller hasAnchor" number="7.35">
<h2><span class="header-section-number">7.35</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="linear-model-selection-and-regularization.html#cb273-1" aria-hidden="true" tabindex="-1"></a>mars_cv_new<span class="sc">$</span>bestTune   <span class="co"># optimal tuning parameters</span></span></code></pre></div>
<pre><code>##   nprune degree
## 2     12      1</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="linear-model-selection-and-regularization.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mars_cv_new<span class="sc">$</span>results<span class="sc">$</span>RMSE)   <span class="co"># optimal CV RMSE</span></span></code></pre></div>
<pre><code>## [1] 56774.49</code></pre>
</div>
<div id="mars-without-feature-engineering-implementation-3" class="section level2 smaller hasAnchor" number="7.36">
<h2><span class="header-section-number">7.36</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="linear-model-selection-and-regularization.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit final optimal model</span></span>
<span id="cb277-2"><a href="linear-model-selection-and-regularization.html#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="linear-model-selection-and-regularization.html#cb277-3" aria-hidden="true" tabindex="-1"></a>final_model_new <span class="ot">&lt;-</span> <span class="fu">earth</span>(Sale_Price <span class="sc">~</span> .,</span>
<span id="cb277-4"><a href="linear-model-selection-and-regularization.html#cb277-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> baked_train,</span>
<span id="cb277-5"><a href="linear-model-selection-and-regularization.html#cb277-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">degree =</span> mars_cv_new<span class="sc">$</span>bestTune<span class="sc">$</span>degree,</span>
<span id="cb277-6"><a href="linear-model-selection-and-regularization.html#cb277-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nprune =</span> mars_cv_new<span class="sc">$</span>bestTune<span class="sc">$</span>nprune)</span></code></pre></div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="linear-model-selection-and-regularization.html#cb278-1" aria-hidden="true" tabindex="-1"></a>final_model_preds_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model_new, <span class="at">newdata =</span> baked_test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)   <span class="co"># obtain predictions</span></span>
<span id="cb278-2"><a href="linear-model-selection-and-regularization.html#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="linear-model-selection-and-regularization.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((final_model_preds_new <span class="sc">-</span> baked_test<span class="sc">$</span>Sale_Price)<span class="sc">^</span><span class="dv">2</span>))   <span class="co"># test RMSE</span></span></code></pre></div>
<pre><code>## [1] 27873.21</code></pre>
</div>
<div id="mars-without-feature-engineering-implementation-4" class="section level2 smaller hasAnchor" number="7.37">
<h2><span class="header-section-number">7.37</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="linear-model-selection-and-regularization.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_model_new)</span></code></pre></div>
<pre><code>## Call: earth(formula=Sale_Price~., data=baked_train,
##             degree=mars_cv_new$bestTune$degree,
##             nprune=mars_cv_new$bestTune$nprune)
## 
##                                       coefficients
## (Intercept)                              328830.60
## Overall_QualVery_Good                     54877.14
## Overall_QualExcellent                    122860.26
## Overall_QualVery_Excellent               200502.50
## MS_SubClassDuplex_All_Styles_and_Ages    -47623.96
## h(5720-Lot_Area)                             -7.07
## h(First_Flr_SF-2032)                        960.47
## h(2110-First_Flr_SF)                        -83.98
## h(First_Flr_SF-2110)                      -1106.04
## h(1277-Second_Flr_SF)                       -56.99
## h(Second_Flr_SF-1277)                       257.79
## h(2000-Year_Built)                         -810.93
## 
## Selected 12 of 33 terms, and 8 of 74 predictors (nprune=12)
## Termination condition: RSq changed by less than 0.001 at 33 terms
## Importance: First_Flr_SF, Second_Flr_SF, Year_Built, ...
## Number of terms at each degree of interaction: 1 11 (additive model)
## GCV 938805472    RSS 537800335247    GRSq 0.8741227    RSq 0.8829393</code></pre>
</div>
<div id="mars-without-feature-engineering-implementation-5" class="section level2 smaller hasAnchor" number="7.38">
<h2><span class="header-section-number">7.38</span> MARS Without Feature Engineering: Implementation<a href="linear-model-selection-and-regularization.html#mars-without-feature-engineering-implementation-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ames Housing Dataset</strong></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="linear-model-selection-and-regularization.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(<span class="at">object =</span> mars_cv_new, <span class="at">num_features =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;model&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-161-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="your-turn-19" class="section level2 smaller hasAnchor" number="7.39">
<h2><span class="header-section-number">7.39</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-19" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will work with the <code>titanic.rds</code> dataset which contains information on Titanic passengers. Please download the dataset from Canvas, upload it to Posit Cloud, and load it using the following code.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="linear-model-selection-and-regularization.html#cb283-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;titanic.rds&quot;</span>)    <span class="co"># load dataset</span></span></code></pre></div>
<p>The variables in the dataset are <code>pclass</code> (passenger class - 1st, 2nd, 3rd), <code>survived</code> (Yes or No), <code>sex</code> (male or female), <code>age</code> (age in years), <code>sibsp</code> (number of siblings or spouses aboard), <code>parch</code> (number of parents or children aboard).</p>
<p>We are interested in predicting <code>survived</code> using the rest of the variables in the dataset. Compare the performance (in terms of <strong>Accuracy</strong>) of the following models:</p>
<ul>
<li><p>A logistic regression model;</p></li>
<li><p>A <span class="math inline">\(K\)</span>-NN model with optimal <span class="math inline">\(K\)</span> chosen by CV;</p></li>
<li><p>A MARS model with optimal hyperparameters chosen by CV;</p></li>
<li><p>A MARS model with minimal feature engineering. Choose the optimal hyperparameters by CV.</p></li>
</ul>
<p><strong>Perform the following tasks.</strong></p>
<ul>
<li><p>Investigate the dataset and complete any necessary tasks.</p></li>
<li><p>Split the data into training and test sets (80-20).</p></li>
<li><p>Perform required data preprocessing and create the blueprint. If using <code>step_dummy()</code>, set <code>one_hot = FALSE</code>. Prepare the blueprint on the training data. Obtain the modified training and test datasets.</p></li>
<li><p>Implement 5-fold CV repeated 5 times for each of the models above.</p></li>
<li><p>Report the optimal CV Accuracy of each model. Report the optimal hyperparameters for each model. Which model performs best in this situation?</p></li>
<li><p>Build the final model. Obtain probability and class label predictions on the test set. Create the corresponding confusion matrix and report the test set accuracy. (Check out the help page of <code>predict.earth</code> and the type of objects created.)</p></li>
</ul>
</div>
<div id="your-turn-20" class="section level2 hasAnchor" number="7.40">
<h2><span class="header-section-number">7.40</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-20" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="linear-model-selection-and-regularization.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(titanic)</span></code></pre></div>
<pre><code>## Rows: 1,046
## Columns: 6
## $ pclass   &lt;fct&gt; 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1st, 1
## $ survived &lt;fct&gt; Yes, Yes, No, No, No, Yes, Yes, No, Yes, No, No, Yes, Yes, Ye
## $ sex      &lt;fct&gt; female, male, female, male, female, male, female, male, femal
## $ age      &lt;dbl&gt; 29.0000, 0.9167, NA, 30.0000, NA, 48.0000, 63.0000, 39.0000, 
## $ sibsp    &lt;int&gt; 0, 1, 1, 1, 1, 0, 1, 0, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1
## $ parch    &lt;int&gt; 0, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 1, 1, 0, 0, 1, </code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="linear-model-selection-and-regularization.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(titanic))</span></code></pre></div>
<pre><code>## [1] 469</code></pre>
</div>
<div id="your-turn-21" class="section level2 hasAnchor" number="7.41">
<h2><span class="header-section-number">7.41</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-21" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="linear-model-selection-and-regularization.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(titanic)</span></code></pre></div>
<pre><code>##  pclass    survived      sex           age              sibsp       
##  1st:284   No :619   female:388   Min.   : 0.1667   Min.   :0.0000  
##  2nd:261   Yes:427   male  :658   1st Qu.:21.0000   1st Qu.:0.0000  
##  3rd:501                          Median :28.0000   Median :0.0000  
##                                   Mean   :29.7110   Mean   :0.5029  
##                                   3rd Qu.:39.0000   3rd Qu.:1.0000  
##                                   Max.   :80.0000   Max.   :8.0000  
##                                   NA&#39;s   :432                       
##      parch       
##  Min.   :0.0000  
##  1st Qu.:0.0000  
##  Median :0.0000  
##  Mean   :0.4232  
##  3rd Qu.:1.0000  
##  Max.   :6.0000  
##  NA&#39;s   :37</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="linear-model-selection-and-regularization.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(titanic<span class="sc">$</span>pclass)   <span class="co"># levels are in order</span></span></code></pre></div>
<pre><code>## [1] &quot;1st&quot; &quot;2nd&quot; &quot;3rd&quot;</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="linear-model-selection-and-regularization.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># age, sibsp, parch are numerical variables</span></span>
<span id="cb292-2"><a href="linear-model-selection-and-regularization.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pclass is an ordinal categorical variable</span></span>
<span id="cb292-3"><a href="linear-model-selection-and-regularization.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sex is a nominal categorical variable</span></span>
<span id="cb292-4"><a href="linear-model-selection-and-regularization.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="co"># missing entries in age and parch</span></span></code></pre></div>
</div>
<div id="your-turn-22" class="section level2 hasAnchor" number="7.42">
<h2><span class="header-section-number">7.42</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="linear-model-selection-and-regularization.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data</span></span>
<span id="cb293-2"><a href="linear-model-selection-and-regularization.html#cb293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-3"><a href="linear-model-selection-and-regularization.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb293-4"><a href="linear-model-selection-and-regularization.html#cb293-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-5"><a href="linear-model-selection-and-regularization.html#cb293-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(titanic<span class="sc">$</span>survived, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)   <span class="co"># 80-20 split</span></span>
<span id="cb293-6"><a href="linear-model-selection-and-regularization.html#cb293-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-7"><a href="linear-model-selection-and-regularization.html#cb293-7" aria-hidden="true" tabindex="-1"></a>titanic_train <span class="ot">&lt;-</span> titanic[index, ]    <span class="co"># training data</span></span>
<span id="cb293-8"><a href="linear-model-selection-and-regularization.html#cb293-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-9"><a href="linear-model-selection-and-regularization.html#cb293-9" aria-hidden="true" tabindex="-1"></a>titanic_test <span class="ot">&lt;-</span> titanic[<span class="sc">-</span>index, ]   <span class="co"># test data</span></span></code></pre></div>
</div>
<div id="your-turn-23" class="section level2 hasAnchor" number="7.43">
<h2><span class="header-section-number">7.43</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-23" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="linear-model-selection-and-regularization.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create recipe and blueprint, prepare, and bake</span></span>
<span id="cb294-2"><a href="linear-model-selection-and-regularization.html#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="linear-model-selection-and-regularization.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)</span>
<span id="cb294-4"><a href="linear-model-selection-and-regularization.html#cb294-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-5"><a href="linear-model-selection-and-regularization.html#cb294-5" aria-hidden="true" tabindex="-1"></a>blueprint <span class="ot">&lt;-</span> <span class="fu">recipe</span>(survived <span class="sc">~</span> ., <span class="at">data =</span> titanic_train) <span class="sc">%&gt;%</span>      <span class="co"># create recipe</span></span>
<span id="cb294-6"><a href="linear-model-selection-and-regularization.html#cb294-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(age) <span class="sc">%&gt;%</span>                      <span class="co"># impute age by mean</span></span>
<span id="cb294-7"><a href="linear-model-selection-and-regularization.html#cb294-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(parch) <span class="sc">%&gt;%</span>                  <span class="co"># impute parch by median since discrete integers</span></span>
<span id="cb294-8"><a href="linear-model-selection-and-regularization.html#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_integer</span>(pclass) <span class="sc">%&gt;%</span>                       <span class="co"># label encoding ordinal feature</span></span>
<span id="cb294-9"><a href="linear-model-selection-and-regularization.html#cb294-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span>   <span class="co"># center and scale numerical features</span></span>
<span id="cb294-10"><a href="linear-model-selection-and-regularization.html#cb294-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(sex, <span class="at">one_hot =</span> <span class="cn">FALSE</span>)               <span class="co"># creating dummy variable for nominal feature</span></span>
<span id="cb294-11"><a href="linear-model-selection-and-regularization.html#cb294-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-12"><a href="linear-model-selection-and-regularization.html#cb294-12" aria-hidden="true" tabindex="-1"></a>prepare <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint, <span class="at">training =</span> titanic_train)    <span class="co"># prepare blueprint on training data</span></span>
<span id="cb294-13"><a href="linear-model-selection-and-regularization.html#cb294-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-14"><a href="linear-model-selection-and-regularization.html#cb294-14" aria-hidden="true" tabindex="-1"></a>baked_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> titanic_train)    <span class="co"># apply the blueprint to training data</span></span>
<span id="cb294-15"><a href="linear-model-selection-and-regularization.html#cb294-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-16"><a href="linear-model-selection-and-regularization.html#cb294-16" aria-hidden="true" tabindex="-1"></a>baked_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> titanic_test)      <span class="co"># apply the blueprint to training data</span></span></code></pre></div>
</div>
<div id="your-turn-24" class="section level2 smaller hasAnchor" number="7.44">
<h2><span class="header-section-number">7.44</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-24" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="linear-model-selection-and-regularization.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up CV </span></span>
<span id="cb295-2"><a href="linear-model-selection-and-regularization.html#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="linear-model-selection-and-regularization.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb295-4"><a href="linear-model-selection-and-regularization.html#cb295-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-5"><a href="linear-model-selection-and-regularization.html#cb295-5" aria-hidden="true" tabindex="-1"></a>cv_specs <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">5</span>, <span class="at">repeats =</span> <span class="dv">5</span>)   <span class="co"># CV specifications</span></span>
<span id="cb295-6"><a href="linear-model-selection-and-regularization.html#cb295-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-7"><a href="linear-model-selection-and-regularization.html#cb295-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-8"><a href="linear-model-selection-and-regularization.html#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with logistic regression</span></span>
<span id="cb295-9"><a href="linear-model-selection-and-regularization.html#cb295-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-10"><a href="linear-model-selection-and-regularization.html#cb295-10" aria-hidden="true" tabindex="-1"></a>logistic_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb295-11"><a href="linear-model-selection-and-regularization.html#cb295-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> titanic_train, </span>
<span id="cb295-12"><a href="linear-model-selection-and-regularization.html#cb295-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb295-13"><a href="linear-model-selection-and-regularization.html#cb295-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb295-14"><a href="linear-model-selection-and-regularization.html#cb295-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> cv_specs,</span>
<span id="cb295-15"><a href="linear-model-selection-and-regularization.html#cb295-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb295-16"><a href="linear-model-selection-and-regularization.html#cb295-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-17"><a href="linear-model-selection-and-regularization.html#cb295-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-18"><a href="linear-model-selection-and-regularization.html#cb295-18" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with KNN</span></span>
<span id="cb295-19"><a href="linear-model-selection-and-regularization.html#cb295-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-20"><a href="linear-model-selection-and-regularization.html#cb295-20" aria-hidden="true" tabindex="-1"></a>k_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">101</span>, <span class="at">by =</span> <span class="dv">10</span>))   <span class="co"># grid of K</span></span>
<span id="cb295-21"><a href="linear-model-selection-and-regularization.html#cb295-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-22"><a href="linear-model-selection-and-regularization.html#cb295-22" aria-hidden="true" tabindex="-1"></a>knn_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint,</span>
<span id="cb295-23"><a href="linear-model-selection-and-regularization.html#cb295-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> titanic_train, </span>
<span id="cb295-24"><a href="linear-model-selection-and-regularization.html#cb295-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb295-25"><a href="linear-model-selection-and-regularization.html#cb295-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">trControl =</span> cv_specs,</span>
<span id="cb295-26"><a href="linear-model-selection-and-regularization.html#cb295-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">tuneGrid =</span> k_grid,</span>
<span id="cb295-27"><a href="linear-model-selection-and-regularization.html#cb295-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb295-28"><a href="linear-model-selection-and-regularization.html#cb295-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-29"><a href="linear-model-selection-and-regularization.html#cb295-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-30"><a href="linear-model-selection-and-regularization.html#cb295-30" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with MARS</span></span>
<span id="cb295-31"><a href="linear-model-selection-and-regularization.html#cb295-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-32"><a href="linear-model-selection-and-regularization.html#cb295-32" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">nprune =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">10</span>))    <span class="co"># grid of tuning parameters</span></span>
<span id="cb295-33"><a href="linear-model-selection-and-regularization.html#cb295-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-34"><a href="linear-model-selection-and-regularization.html#cb295-34" aria-hidden="true" tabindex="-1"></a>mars_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint, </span>
<span id="cb295-35"><a href="linear-model-selection-and-regularization.html#cb295-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> titanic_train, </span>
<span id="cb295-36"><a href="linear-model-selection-and-regularization.html#cb295-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;earth&quot;</span>,</span>
<span id="cb295-37"><a href="linear-model-selection-and-regularization.html#cb295-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> cv_specs,</span>
<span id="cb295-38"><a href="linear-model-selection-and-regularization.html#cb295-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tuneGrid =</span> param_grid,</span>
<span id="cb295-39"><a href="linear-model-selection-and-regularization.html#cb295-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div id="your-turn-25" class="section level2 smaller hasAnchor" number="7.45">
<h2><span class="header-section-number">7.45</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-25" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="linear-model-selection-and-regularization.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create recipe and blueprint, prepare, and bake</span></span>
<span id="cb297-2"><a href="linear-model-selection-and-regularization.html#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="linear-model-selection-and-regularization.html#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">021423</span>)   <span class="co"># set seed</span></span>
<span id="cb297-4"><a href="linear-model-selection-and-regularization.html#cb297-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-5"><a href="linear-model-selection-and-regularization.html#cb297-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-6"><a href="linear-model-selection-and-regularization.html#cb297-6" aria-hidden="true" tabindex="-1"></a>blueprint_new <span class="ot">&lt;-</span> <span class="fu">recipe</span>(survived <span class="sc">~</span> ., <span class="at">data =</span> titanic_train) <span class="sc">%&gt;%</span>   <span class="co"># create recipe </span></span>
<span id="cb297-7"><a href="linear-model-selection-and-regularization.html#cb297-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(age) <span class="sc">%&gt;%</span>                                       <span class="co"># impute age by mean</span></span>
<span id="cb297-8"><a href="linear-model-selection-and-regularization.html#cb297-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(parch)                                       <span class="co"># impute parch by median since discrete integers</span></span>
<span id="cb297-9"><a href="linear-model-selection-and-regularization.html#cb297-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-10"><a href="linear-model-selection-and-regularization.html#cb297-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-11"><a href="linear-model-selection-and-regularization.html#cb297-11" aria-hidden="true" tabindex="-1"></a>prepare_new <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint_new, <span class="at">data =</span> titanic_train)    <span class="co"># prepare blueprint on training data</span></span>
<span id="cb297-12"><a href="linear-model-selection-and-regularization.html#cb297-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-13"><a href="linear-model-selection-and-regularization.html#cb297-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-14"><a href="linear-model-selection-and-regularization.html#cb297-14" aria-hidden="true" tabindex="-1"></a>baked_train_new <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare_new, <span class="at">new_data =</span> titanic_train)   <span class="co"># apply the blueprint to training data</span></span>
<span id="cb297-15"><a href="linear-model-selection-and-regularization.html#cb297-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-16"><a href="linear-model-selection-and-regularization.html#cb297-16" aria-hidden="true" tabindex="-1"></a>baked_test_new <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare_new, <span class="at">new_data =</span> titanic_test)    <span class="co"># apply the blueprint to test data</span></span>
<span id="cb297-17"><a href="linear-model-selection-and-regularization.html#cb297-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-18"><a href="linear-model-selection-and-regularization.html#cb297-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-19"><a href="linear-model-selection-and-regularization.html#cb297-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-20"><a href="linear-model-selection-and-regularization.html#cb297-20" aria-hidden="true" tabindex="-1"></a><span class="co"># CV with MARS (minimal feature engineering)</span></span>
<span id="cb297-21"><a href="linear-model-selection-and-regularization.html#cb297-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-22"><a href="linear-model-selection-and-regularization.html#cb297-22" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">degree =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">nprune =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">10</span>))    <span class="co"># grid of tuning parameters</span></span>
<span id="cb297-23"><a href="linear-model-selection-and-regularization.html#cb297-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-24"><a href="linear-model-selection-and-regularization.html#cb297-24" aria-hidden="true" tabindex="-1"></a>mars_cv_new <span class="ot">&lt;-</span> <span class="fu">train</span>(blueprint_new,</span>
<span id="cb297-25"><a href="linear-model-selection-and-regularization.html#cb297-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> titanic_train,</span>
<span id="cb297-26"><a href="linear-model-selection-and-regularization.html#cb297-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;earth&quot;</span>,</span>
<span id="cb297-27"><a href="linear-model-selection-and-regularization.html#cb297-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> cv_specs,</span>
<span id="cb297-28"><a href="linear-model-selection-and-regularization.html#cb297-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">tuneGrid =</span> param_grid,</span>
<span id="cb297-29"><a href="linear-model-selection-and-regularization.html#cb297-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div id="your-turn-26" class="section level2 hasAnchor" number="7.46">
<h2><span class="header-section-number">7.46</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-26" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="linear-model-selection-and-regularization.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal CV Accuracies</span></span>
<span id="cb299-2"><a href="linear-model-selection-and-regularization.html#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="linear-model-selection-and-regularization.html#cb299-3" aria-hidden="true" tabindex="-1"></a>logistic_cv<span class="sc">$</span>results<span class="sc">$</span>Accuracy    <span class="co"># logistic regression </span></span></code></pre></div>
<pre><code>## [1] 0.7698763</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="linear-model-selection-and-regularization.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(knn_cv<span class="sc">$</span>results<span class="sc">$</span>Accuracy)    <span class="co"># KNN</span></span></code></pre></div>
<pre><code>## [1] 0.7680305</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="linear-model-selection-and-regularization.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mars_cv<span class="sc">$</span>results<span class="sc">$</span>Accuracy)   <span class="co"># MARS</span></span></code></pre></div>
<pre><code>## [1] 0.7897419</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="linear-model-selection-and-regularization.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mars_cv_new<span class="sc">$</span>results<span class="sc">$</span>Accuracy)   <span class="co"># MARS (minimal feature preprocessing)</span></span></code></pre></div>
<pre><code>## [1] 0.7875914</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="linear-model-selection-and-regularization.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The optimal MARS model with proper feature engineering seems to perform the best.</span></span></code></pre></div>
</div>
<div id="your-turn-27" class="section level2 hasAnchor" number="7.47">
<h2><span class="header-section-number">7.47</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-27" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="linear-model-selection-and-regularization.html#cb308-1" aria-hidden="true" tabindex="-1"></a>knn_cv<span class="sc">$</span>bestTune<span class="sc">$</span>k        <span class="co"># optimal K</span></span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="linear-model-selection-and-regularization.html#cb310-1" aria-hidden="true" tabindex="-1"></a>mars_cv<span class="sc">$</span>bestTune   <span class="co"># optimal MARS hyperparameters</span></span></code></pre></div>
<pre><code>##    nprune degree
## 12     12      2</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="linear-model-selection-and-regularization.html#cb312-1" aria-hidden="true" tabindex="-1"></a>mars_cv_new<span class="sc">$</span>bestTune   <span class="co"># optimal MARS hyperparameters with minimal feature engineering</span></span></code></pre></div>
<pre><code>##    nprune degree
## 22     12      3</code></pre>
</div>
<div id="your-turn-28" class="section level2 hasAnchor" number="7.48">
<h2><span class="header-section-number">7.48</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-28" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="linear-model-selection-and-regularization.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build final model</span></span>
<span id="cb314-2"><a href="linear-model-selection-and-regularization.html#cb314-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3"><a href="linear-model-selection-and-regularization.html#cb314-3" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">earth</span>(survived <span class="sc">~</span> .,</span>
<span id="cb314-4"><a href="linear-model-selection-and-regularization.html#cb314-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> baked_train,</span>
<span id="cb314-5"><a href="linear-model-selection-and-regularization.html#cb314-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">degree =</span> mars_cv<span class="sc">$</span>bestTune<span class="sc">$</span>degree,   <span class="co"># optimal degree of interactions</span></span>
<span id="cb314-6"><a href="linear-model-selection-and-regularization.html#cb314-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nprune =</span> mars_cv<span class="sc">$</span>bestTune<span class="sc">$</span>nprune,   <span class="co"># optimal number of terms after pruning</span></span>
<span id="cb314-7"><a href="linear-model-selection-and-regularization.html#cb314-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">glm =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial))</span></code></pre></div>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="linear-model-selection-and-regularization.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain predictions on test data</span></span>
<span id="cb315-2"><a href="linear-model-selection-and-regularization.html#cb315-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-3"><a href="linear-model-selection-and-regularization.html#cb315-3" aria-hidden="true" tabindex="-1"></a>final_model_prob_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newdata =</span> baked_test, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)   <span class="co"># probability predictions</span></span>
<span id="cb315-4"><a href="linear-model-selection-and-regularization.html#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="linear-model-selection-and-regularization.html#cb315-5" aria-hidden="true" tabindex="-1"></a>final_model_class_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newdata =</span> baked_test, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)   <span class="co"># class label predictions</span></span></code></pre></div>
</div>
<div id="your-turn-29" class="section level2 smaller hasAnchor" number="7.49">
<h2><span class="header-section-number">7.49</span> <span style="color:blue">Your Turn!!!</span><a href="linear-model-selection-and-regularization.html#your-turn-29" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Titanic Dataset</strong></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="linear-model-selection-and-regularization.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the class label predictions are &#39;character&#39; types.</span></span>
<span id="cb316-2"><a href="linear-model-selection-and-regularization.html#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to convert then into &#39;factor&#39; type</span></span>
<span id="cb316-3"><a href="linear-model-selection-and-regularization.html#cb316-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-4"><a href="linear-model-selection-and-regularization.html#cb316-4" aria-hidden="true" tabindex="-1"></a>final_model_class_preds <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_model_class_preds)</span>
<span id="cb316-5"><a href="linear-model-selection-and-regularization.html#cb316-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-6"><a href="linear-model-selection-and-regularization.html#cb316-6" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb316-7"><a href="linear-model-selection-and-regularization.html#cb316-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-8"><a href="linear-model-selection-and-regularization.html#cb316-8" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> <span class="fu">relevel</span>(final_model_class_preds, <span class="at">ref =</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb316-9"><a href="linear-model-selection-and-regularization.html#cb316-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> <span class="fu">relevel</span>(baked_test<span class="sc">$</span>survived, <span class="at">ref =</span> <span class="st">&quot;Yes&quot;</span>))</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Yes  No
##        Yes  59  13
##        No   26 110
##                                           
##                Accuracy : 0.8125          
##                  95% CI : (0.7527, 0.8631)
##     No Information Rate : 0.5913          
##     P-Value [Acc &gt; NIR] : 7.915e-12       
##                                           
##                   Kappa : 0.6027          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.05466         
##                                           
##             Sensitivity : 0.6941          
##             Specificity : 0.8943          
##          Pos Pred Value : 0.8194          
##          Neg Pred Value : 0.8088          
##              Prevalence : 0.4087          
##          Detection Rate : 0.2837          
##    Detection Prevalence : 0.3462          
##       Balanced Accuracy : 0.7942          
##                                           
##        &#39;Positive&#39; Class : Yes             
## </code></pre>

<!-- ```{r , echo=FALSE,  fig.align='center', out.width = '90%'} -->
<!-- knitr::include_graphics("EFT/SL1.png") -->
<!-- ``` -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="review-of-cv.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tree-based-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/abhicc/208notes/edit/master/06-Slides7.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/abhicc/208notes/blob/master/06-Slides7.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
